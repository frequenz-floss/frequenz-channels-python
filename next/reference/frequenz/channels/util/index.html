
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Channel implementations for Python">
      
      
        <meta name="author" content="Frequenz Energy-as-a-Service GmbH">
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../../../../CONTRIBUTING/">
      
      <link rel="icon" href="../../../../logo.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.18">
    
    
      
        <title>util - Frequenz channels</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../css/style.css">
    
      <link rel="stylesheet" href="../../../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#frequenz.channels.util" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest (stable) version.
  <a href="../../../../..">
    <strong>Click here to go to latest (stable) version</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Frequenz channels" class="md-header__button md-logo" aria-label="Frequenz channels" data-md-component="logo">
      
  <img src="../../../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Frequenz channels
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              util
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/frequenz-floss/frequenz-channels-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    frequenz-channels-python
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../conftest/" class="md-tabs__link md-tabs__link--active">
        API Reference
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../CONTRIBUTING/" class="md-tabs__link">
      Contributing
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Frequenz channels" class="md-nav__button md-logo" aria-label="Frequenz channels" data-md-component="logo">
      
  <img src="../../../../logo.png" alt="logo">

    </a>
    Frequenz channels
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/frequenz-floss/frequenz-channels-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    frequenz-channels-python
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../conftest/" class="md-nav__link">
        conftest
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          frequenz
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          frequenz
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" checked>
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">channels</a>
          
            <label for="__nav_2_2_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_2_1">
          <span class="md-nav__icon md-icon"></span>
          channels
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          util
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        util
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#frequenz.channels.util" class="md-nav__link">
    util
  </a>
  
    <nav class="md-nav" aria-label="util">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Event" class="md-nav__link">
    Event
  </a>
  
    <nav class="md-nav" aria-label="Event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Event-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.is_set" class="md-nav__link">
    is_set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.is_stopped" class="md-nav__link">
    is_stopped
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.name" class="md-nav__link">
    name
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Event-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.set" class="md-nav__link">
    set()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.FileWatcher" class="md-nav__link">
    FileWatcher
  </a>
  
    <nav class="md-nav" aria-label="FileWatcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.FileWatcher-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.Event" class="md-nav__link">
    Event
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.EventType" class="md-nav__link">
    EventType
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.FileWatcher-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Merge" class="md-nav__link">
    Merge
  </a>
  
    <nav class="md-nav" aria-label="Merge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Merge-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.MergeNamed" class="md-nav__link">
    MergeNamed
  </a>
  
    <nav class="md-nav" aria-label="MergeNamed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.MergeNamed-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.MissedTickPolicy" class="md-nav__link">
    MissedTickPolicy
  </a>
  
    <nav class="md-nav" aria-label="MissedTickPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.MissedTickPolicy-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.MissedTickPolicy.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.MissedTickPolicy.calculate_next_tick_time" class="md-nav__link">
    calculate_next_tick_time()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SelectError" class="md-nav__link">
    SelectError
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SelectErrorGroup" class="md-nav__link">
    SelectErrorGroup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Selected" class="md-nav__link">
    Selected
  </a>
  
    <nav class="md-nav" aria-label="Selected">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Selected-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.exception" class="md-nav__link">
    exception
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.value" class="md-nav__link">
    value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.value--noqa-dar401-_exception" class="md-nav__link">
    noqa: DAR401 _exception
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Selected-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.was_stopped" class="md-nav__link">
    was_stopped()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndDrift" class="md-nav__link">
    SkipMissedAndDrift
  </a>
  
    <nav class="md-nav" aria-label="SkipMissedAndDrift">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndDrift-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.delay_tolerance" class="md-nav__link">
    delay_tolerance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndDrift-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.calculate_next_tick_time" class="md-nav__link">
    calculate_next_tick_time()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndResync" class="md-nav__link">
    SkipMissedAndResync
  </a>
  
    <nav class="md-nav" aria-label="SkipMissedAndResync">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndResync-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndResync.calculate_next_tick_time" class="md-nav__link">
    calculate_next_tick_time()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Timer" class="md-nav__link">
    Timer
  </a>
  
    <nav class="md-nav" aria-label="Timer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Timer-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.interval" class="md-nav__link">
    interval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.is_running" class="md-nav__link">
    is_running
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.loop" class="md-nav__link">
    loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.missed_tick_policy" class="md-nav__link">
    missed_tick_policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Timer-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.periodic" class="md-nav__link">
    periodic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.reset" class="md-nav__link">
    reset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.timeout" class="md-nav__link">
    timeout()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.TriggerAllMissed" class="md-nav__link">
    TriggerAllMissed
  </a>
  
    <nav class="md-nav" aria-label="TriggerAllMissed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.TriggerAllMissed-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.TriggerAllMissed.calculate_next_tick_time" class="md-nav__link">
    calculate_next_tick_time()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.UnhandledSelectedError" class="md-nav__link">
    UnhandledSelectedError
  </a>
  
    <nav class="md-nav" aria-label="UnhandledSelectedError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.UnhandledSelectedError-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.UnhandledSelectedError.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.select" class="md-nav__link">
    select()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.selected_from" class="md-nav__link">
    selected_from()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../CONTRIBUTING/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#frequenz.channels.util" class="md-nav__link">
    util
  </a>
  
    <nav class="md-nav" aria-label="util">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Event" class="md-nav__link">
    Event
  </a>
  
    <nav class="md-nav" aria-label="Event">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Event-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.is_set" class="md-nav__link">
    is_set
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.is_stopped" class="md-nav__link">
    is_stopped
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.name" class="md-nav__link">
    name
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Event-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.set" class="md-nav__link">
    set()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._event.Event.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.FileWatcher" class="md-nav__link">
    FileWatcher
  </a>
  
    <nav class="md-nav" aria-label="FileWatcher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.FileWatcher-classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.Event" class="md-nav__link">
    Event
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.EventType" class="md-nav__link">
    EventType
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.FileWatcher-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._file_watcher.FileWatcher.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Merge" class="md-nav__link">
    Merge
  </a>
  
    <nav class="md-nav" aria-label="Merge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Merge-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge.Merge.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.MergeNamed" class="md-nav__link">
    MergeNamed
  </a>
  
    <nav class="md-nav" aria-label="MergeNamed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.MergeNamed-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.__del__" class="md-nav__link">
    __del__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._merge_named.MergeNamed.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.MissedTickPolicy" class="md-nav__link">
    MissedTickPolicy
  </a>
  
    <nav class="md-nav" aria-label="MissedTickPolicy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.MissedTickPolicy-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.MissedTickPolicy.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.MissedTickPolicy.calculate_next_tick_time" class="md-nav__link">
    calculate_next_tick_time()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SelectError" class="md-nav__link">
    SelectError
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SelectErrorGroup" class="md-nav__link">
    SelectErrorGroup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Selected" class="md-nav__link">
    Selected
  </a>
  
    <nav class="md-nav" aria-label="Selected">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Selected-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.exception" class="md-nav__link">
    exception
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.value" class="md-nav__link">
    value
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.value--noqa-dar401-_exception" class="md-nav__link">
    noqa: DAR401 _exception
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Selected-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.Selected.was_stopped" class="md-nav__link">
    was_stopped()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndDrift" class="md-nav__link">
    SkipMissedAndDrift
  </a>
  
    <nav class="md-nav" aria-label="SkipMissedAndDrift">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndDrift-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.delay_tolerance" class="md-nav__link">
    delay_tolerance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndDrift-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndDrift.calculate_next_tick_time" class="md-nav__link">
    calculate_next_tick_time()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndResync" class="md-nav__link">
    SkipMissedAndResync
  </a>
  
    <nav class="md-nav" aria-label="SkipMissedAndResync">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.SkipMissedAndResync-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.SkipMissedAndResync.calculate_next_tick_time" class="md-nav__link">
    calculate_next_tick_time()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Timer" class="md-nav__link">
    Timer
  </a>
  
    <nav class="md-nav" aria-label="Timer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Timer-attributes" class="md-nav__link">
    Attributes
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.interval" class="md-nav__link">
    interval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.is_running" class="md-nav__link">
    is_running
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.loop" class="md-nav__link">
    loop
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.missed_tick_policy" class="md-nav__link">
    missed_tick_policy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.Timer-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.__str__" class="md-nav__link">
    __str__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.consume" class="md-nav__link">
    consume()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.periodic" class="md-nav__link">
    periodic()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.ready" class="md-nav__link">
    ready()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.reset" class="md-nav__link">
    reset()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.stop" class="md-nav__link">
    stop()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.Timer.timeout" class="md-nav__link">
    timeout()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.TriggerAllMissed" class="md-nav__link">
    TriggerAllMissed
  </a>
  
    <nav class="md-nav" aria-label="TriggerAllMissed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.TriggerAllMissed-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._timer.TriggerAllMissed.calculate_next_tick_time" class="md-nav__link">
    calculate_next_tick_time()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.UnhandledSelectedError" class="md-nav__link">
    UnhandledSelectedError
  </a>
  
    <nav class="md-nav" aria-label="UnhandledSelectedError">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.UnhandledSelectedError-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util._select.UnhandledSelectedError.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util-functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.select" class="md-nav__link">
    select()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.channels.util.selected_from" class="md-nav__link">
    selected_from()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>util</h1>

<div class="doc doc-object doc-module">



<h2 id="frequenz.channels.util" class="doc doc-heading">
          <code>frequenz.channels.util</code>


<a href="#frequenz.channels.util" class="headerlink" title="Permanent link"></a></h2>

  <div class="doc doc-contents first">
  
      <p>Channel utilities.</p>
<p>A module with several utilities to work with channels:</p>
<ul>
<li>
<p><a class="autorefs autorefs-internal" href="#frequenz.channels.util.Event">Event</a>:
  A <a class="autorefs autorefs-internal" href="../#frequenz.channels.Receiver">receiver</a> that can be made ready through an event.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="#frequenz.channels.util.FileWatcher">FileWatcher</a>:
  A <a class="autorefs autorefs-internal" href="../#frequenz.channels.Receiver">receiver</a> that watches for file events.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="#frequenz.channels.util.Merge">Merge</a>:
  A <a class="autorefs autorefs-internal" href="../#frequenz.channels.Receiver">receiver</a> that merge messages coming from
  multiple receivers into a single stream.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="#frequenz.channels.util.MergeNamed">MergeNamed</a>:
  A <a class="autorefs autorefs-internal" href="../#frequenz.channels.Receiver">receiver</a> that merge messages coming from
  multiple receivers into a single named stream, allowing to identify the
  origin of each message.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="#frequenz.channels.util.Timer">Timer</a>:
  A <a class="autorefs autorefs-internal" href="../#frequenz.channels.Receiver">receiver</a> that ticks at certain intervals.</p>
</li>
<li>
<p><a class="autorefs autorefs-internal" href="#frequenz.channels.util.select">select</a>:  Iterate over the values of all
  <a class="autorefs autorefs-internal" href="../#frequenz.channels.Receiver">receivers</a> as new values become available.</p>
</li>
</ul>

  

  <div class="doc doc-children">






<h3 id="frequenz.channels.util-classes">Classes<a href="#frequenz.channels.util-classes" class="headerlink" title="Permanent link"></a></h3>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.Event" class="doc doc-heading">
        <code>frequenz.channels.util.Event</code>


<a href="#frequenz.channels.util.Event" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="frequenz.channels._base_classes">_base_classes</span>.<a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[None]</code></p>

  
      <p>A receiver that can be made ready through an event.</p>
<p>The receiver (the <a class="autorefs autorefs-internal" href="#frequenz.channels.util._event.Event.ready"><code>ready()</code></a> method) will wait
until <a class="autorefs autorefs-internal" href="#frequenz.channels.util._event.Event.set"><code>set()</code></a> is called.  At that point the
receiver will wait again after the event is
<a class="autorefs autorefs-internal" href="../#frequenz.channels._base_classes.Receiver.consume"><code>consume()</code></a>d.</p>
<p>The receiver can be completely stopped by calling
<a class="autorefs autorefs-internal" href="#frequenz.channels.util._event.Event.stop"><code>stop()</code></a>.</p>

<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">from</span> <span class="nn">frequenz.channels</span> <span class="kn">import</span> <span class="n">Receiver</span>
<span class="kn">from</span> <span class="nn">frequenz.channels.util</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">selected_from</span>

<span class="n">other_receiver</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">exit_event</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

<span class="k">async</span> <span class="k">def</span> <span class="nf">exit_after_10_seconds</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">exit_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="n">asyncio</span><span class="o">.</span><span class="n">ensure_future</span><span class="p">(</span><span class="n">exit_after_10_seconds</span><span class="p">())</span>

<span class="k">async</span> <span class="k">for</span> <span class="n">selected</span> <span class="ow">in</span> <span class="n">select</span><span class="p">(</span><span class="n">exit_event</span><span class="p">,</span> <span class="n">other_receiver</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">exit_event</span><span class="p">):</span>
        <span class="k">break</span>
    <span class="k">if</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">other_receiver</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Unknow receiver selected&quot;</span>
</code></pre></div>
</details>

        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_event.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Event</span><span class="p">(</span><span class="n">_base_classes</span><span class="o">.</span><span class="n">Receiver</span><span class="p">[</span><span class="kc">None</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A receiver that can be made ready through an event.</span>

<span class="sd">    The receiver (the [`ready()`][frequenz.channels.util.Event.ready] method) will wait</span>
<span class="sd">    until [`set()`][frequenz.channels.util.Event.set] is called.  At that point the</span>
<span class="sd">    receiver will wait again after the event is</span>
<span class="sd">    [`consume()`][frequenz.channels.Receiver.consume]d.</span>

<span class="sd">    The receiver can be completely stopped by calling</span>
<span class="sd">    [`stop()`][frequenz.channels.util.Event.stop].</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import asyncio</span>
<span class="sd">        from frequenz.channels import Receiver</span>
<span class="sd">        from frequenz.channels.util import Event, select, selected_from</span>

<span class="sd">        other_receiver: Receiver[int] = ...</span>
<span class="sd">        exit_event = Event()</span>

<span class="sd">        async def exit_after_10_seconds() -&gt; None:</span>
<span class="sd">            asyncio.sleep(10)</span>
<span class="sd">            exit_event.set()</span>

<span class="sd">        asyncio.ensure_future(exit_after_10_seconds())</span>

<span class="sd">        async for selected in select(exit_event, other_receiver):</span>
<span class="sd">            if selected_from(selected, exit_event):</span>
<span class="sd">                break</span>
<span class="sd">            if selected_from(selected, other_receiver):</span>
<span class="sd">                print(selected.value)</span>
<span class="sd">            else:</span>
<span class="sd">                assert False, &quot;Unknow receiver selected&quot;</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            name: The name of the receiver.  If `None` the `id(self)` will be used as</span>
<span class="sd">                the name.  This is only for debugging purposes, it will be shown in the</span>
<span class="sd">                string representation of the receiver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="p">:</span> <span class="n">_asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">_asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The event that is set when the receiver is ready.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The name of the receiver.</span>

<span class="sd">        This is for debugging purposes, it will be shown in the string representation</span>
<span class="sd">        of the receiver.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the receiver is ready to be consumed.</span>

<span class="sd">        This is used to differentiate between when the receiver was stopped (the event</span>
<span class="sd">        is triggered too) but still there is an event to be consumed and when it was</span>
<span class="sd">        stopped but was not explicitly set().</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the receiver is stopped.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The name of this receiver.</span>

<span class="sd">        This is for debugging purposes, it will be shown in the string representation</span>
<span class="sd">        of this receiver.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The name of this receiver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_set</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether this receiver is set (ready).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether this receiver is set (ready).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_stopped</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether this receiver is stopped.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether this receiver is stopped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop this receiver.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Trigger the event (make the receiver ready).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait until this receiver is ready.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether this receiver is still running.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Consume the event.</span>

<span class="sd">        This makes this receiver wait again until the event is set again.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ReceiverStoppedError: If this receiver is stopped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">_exceptions</span><span class="o">.</span><span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span><span class="p">,</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of this receiver.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string representation of this receiver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">!r}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of this receiver.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string representation of this receiver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">!r}</span><span class="s2"> is_set=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_set</span><span class="si">!r}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;is_stopped=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_stopped</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">





<h5 id="frequenz.channels.util.Event-attributes">Attributes<a href="#frequenz.channels.util.Event-attributes" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._event.Event.is_set" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_set</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._event.Event.is_set" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Whether this receiver is set (ready).</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether this receiver is set (ready).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._event.Event.is_stopped" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_stopped</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._event.Event.is_stopped" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Whether this receiver is stopped.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether this receiver is stopped.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._event.Event.name" class="doc doc-heading">
<code class="highlight language-python"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._event.Event.name" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>The name of this receiver.</p>
<p>This is for debugging purposes, it will be shown in the string representation
of this receiver.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The name of this receiver.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<h5 id="frequenz.channels.util.Event-functions">Functions<a href="#frequenz.channels.util.Event-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._event.Event.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#frequenz.channels.util._event.Event.__init__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a new instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The name of the receiver.  If <code>None</code> the <code>id(self)</code> will be used as
the name.  This is only for debugging purposes, it will be shown in the
string representation of the receiver.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_event.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        name: The name of the receiver.  If `None` the `id(self)` will be used as</span>
<span class="sd">            the name.  This is only for debugging purposes, it will be shown in the</span>
<span class="sd">            string representation of the receiver.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="p">:</span> <span class="n">_asyncio</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">_asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The event that is set when the receiver is ready.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The name of the receiver.</span>

<span class="sd">    This is for debugging purposes, it will be shown in the string representation</span>
<span class="sd">    of the receiver.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Whether the receiver is ready to be consumed.</span>

<span class="sd">    This is used to differentiate between when the receiver was stopped (the event</span>
<span class="sd">    is triggered too) but still there is an event to be consumed and when it was</span>
<span class="sd">    stopped but was not explicitly set().</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Whether the receiver is stopped.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._event.Event.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._event.Event.__repr__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a string representation of this receiver.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A string representation of this receiver.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_event.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of this receiver.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A string representation of this receiver.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">!r}</span><span class="s2"> is_set=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_set</span><span class="si">!r}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;is_stopped=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_stopped</span><span class="si">!r}</span><span class="s2">&gt;&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._event.Event.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._event.Event.__str__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a string representation of this receiver.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A string representation of this receiver.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_event.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of this receiver.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A string representation of this receiver.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">!r}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._event.Event.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._event.Event.consume" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Consume the event.</p>
<p>This makes this receiver wait again until the event is set again.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels._exceptions.ReceiverStoppedError" href="../#frequenz.channels.ReceiverStoppedError">ReceiverStoppedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>If this receiver is stopped.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_event.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Consume the event.</span>

<span class="sd">    This makes this receiver wait again until the event is set again.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ReceiverStoppedError: If this receiver is stopped.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">_exceptions</span><span class="o">.</span><span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span><span class="p">,</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._event.Event.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.util._event.Event.ready" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until this receiver is ready.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether this receiver is still running.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_event.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait until this receiver is ready.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether this receiver is still running.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._event.Event.set" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">set</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._event.Event.set" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Trigger the event (make the receiver ready).</p>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_event.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Trigger the event (make the receiver ready).&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_set</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._event.Event.stop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stop</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._event.Event.stop" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Stop this receiver.</p>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_event.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop this receiver.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_stopped</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.FileWatcher" class="doc doc-heading">
        <code>frequenz.channels.util.FileWatcher</code>


<a href="#frequenz.channels.util.FileWatcher" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[&#39;FileWatcher.Event&#39;]</code></p>

  
      <p>A channel receiver that watches for file events.</p>


        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_file_watcher.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileWatcher</span><span class="p">(</span><span class="n">Receiver</span><span class="p">[</span><span class="s2">&quot;FileWatcher.Event&quot;</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A channel receiver that watches for file events.&quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">EventType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Available types of changes to watch for.&quot;&quot;&quot;</span>

        <span class="n">CREATE</span> <span class="o">=</span> <span class="n">Change</span><span class="o">.</span><span class="n">added</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A new file was created.&quot;&quot;&quot;</span>

        <span class="n">MODIFY</span> <span class="o">=</span> <span class="n">Change</span><span class="o">.</span><span class="n">modified</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An existing file was modified.&quot;&quot;&quot;</span>

        <span class="n">DELETE</span> <span class="o">=</span> <span class="n">Change</span><span class="o">.</span><span class="n">deleted</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An existing file was deleted.&quot;&quot;&quot;</span>

    <span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">class</span> <span class="nc">Event</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A file change event.&quot;&quot;&quot;</span>

        <span class="nb">type</span><span class="p">:</span> <span class="n">FileWatcher</span><span class="o">.</span><span class="n">EventType</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The type of change that was observed.&quot;&quot;&quot;</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The path where the change was observed.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">event_types</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">EventType</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">EventType</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a `FileWatcher` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            paths: Paths to watch for changes.</span>
<span class="sd">            event_types: Types of events to watch for. Defaults to watch for</span>
<span class="sd">                all event types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_types</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">[</span><span class="n">FileWatcher</span><span class="o">.</span><span class="n">EventType</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">event_types</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">path</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="k">else</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_awatch</span> <span class="o">=</span> <span class="n">awatch</span><span class="p">(</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_paths</span><span class="p">,</span> <span class="n">stop_event</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="p">,</span> <span class="n">watch_filter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_events</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_awatch_stopped_exc</span><span class="p">:</span> <span class="ne">Exception</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">FileChange</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_filter_events</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">change</span><span class="p">:</span> <span class="n">Change</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter events based on the event type and path.</span>

<span class="sd">        Args:</span>
<span class="sd">            change: The type of change to be notified.</span>
<span class="sd">            path: The path of the file that changed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the event should be notified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">change</span> <span class="ow">in</span> <span class="p">[</span><span class="n">event_type</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">event_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_types</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cleanup registered watches.</span>

<span class="sd">        `awatch` passes the `stop_event` to a separate task/thread. This way</span>
<span class="sd">        `awatch` getting destroyed properly. The background task will continue</span>
<span class="sd">        until the signal is received.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value or an error.</span>

<span class="sd">        Once a call to `ready()` has finished, the value should be read with</span>
<span class="sd">        a call to `consume()` (`receive()` or iterated over). The receiver will</span>
<span class="sd">        remain ready (this method will return immediately) until it is</span>
<span class="sd">        consumed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the receiver is still active.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># if it was already stopped, return immediately.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_awatch_stopped_exc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_awatch</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">StopAsyncIteration</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_awatch_stopped_exc</span> <span class="o">=</span> <span class="n">err</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the latest event once `ready` is complete.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next event that was received.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ReceiverStoppedError: if there is some problem with the receiver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_awatch_stopped_exc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">self._awatch_stopped_exc</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">,</span> <span class="s2">&quot;`consume()` must be preceeded by a call to `ready()`&quot;</span>
        <span class="c1"># Tuple of (Change, path) returned by watchfiles</span>
        <span class="n">change</span><span class="p">,</span> <span class="n">path_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">FileWatcher</span><span class="o">.</span><span class="n">Event</span><span class="p">(</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">FileWatcher</span><span class="o">.</span><span class="n">EventType</span><span class="p">(</span><span class="n">change</span><span class="p">),</span> <span class="n">path</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">






<h5 id="frequenz.channels.util.FileWatcher-classes">Classes<a href="#frequenz.channels.util.FileWatcher-classes" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-class">



<h6 id="frequenz.channels.util._file_watcher.FileWatcher.Event" class="doc doc-heading">
        <code>Event</code>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.Event" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">

  
      <p>A file change event.</p>


        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_file_watcher.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Event</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A file change event.&quot;&quot;&quot;</span>

    <span class="nb">type</span><span class="p">:</span> <span class="n">FileWatcher</span><span class="o">.</span><span class="n">EventType</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The type of change that was observed.&quot;&quot;&quot;</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The path where the change was observed.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">





<h7 id="frequenz.channels.util._file_watcher.FileWatcher.Event-attributes">Attributes<a href="#frequenz.channels.util._file_watcher.FileWatcher.Event-attributes" class="headerlink" title="Permanent link"></a></h7>

<div class="doc doc-object doc-attribute">



<h8 id="frequenz.channels.util._file_watcher.FileWatcher.Event.path" class="doc doc-heading">
<code class="highlight language-python"><span class="n">path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.Event.path" class="headerlink" title="Permanent link"></a></h8>


  <div class="doc doc-contents ">
  
      <p>The path where the change was observed.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h8 id="frequenz.channels.util._file_watcher.FileWatcher.Event.type" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">type</span><span class="p">:</span> <span class="n">FileWatcher</span><span class="o">.</span><span class="n">EventType</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.Event.type" class="headerlink" title="Permanent link"></a></h8>


  <div class="doc doc-contents ">
  
      <p>The type of change that was observed.</p>
  </div>

</div>





  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h6 id="frequenz.channels.util._file_watcher.FileWatcher.EventType" class="doc doc-heading">
        <code>EventType</code>


<a href="#frequenz.channels.util._file_watcher.FileWatcher.EventType" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" title="enum.Enum" href="https://docs.python.org/3/library/enum.html#enum.Enum">Enum</a></code></p>

  
      <p>Available types of changes to watch for.</p>


        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_file_watcher.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EventType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Available types of changes to watch for.&quot;&quot;&quot;</span>

    <span class="n">CREATE</span> <span class="o">=</span> <span class="n">Change</span><span class="o">.</span><span class="n">added</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A new file was created.&quot;&quot;&quot;</span>

    <span class="n">MODIFY</span> <span class="o">=</span> <span class="n">Change</span><span class="o">.</span><span class="n">modified</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An existing file was modified.&quot;&quot;&quot;</span>

    <span class="n">DELETE</span> <span class="o">=</span> <span class="n">Change</span><span class="o">.</span><span class="n">deleted</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An existing file was deleted.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">





<h7 id="frequenz.channels.util._file_watcher.FileWatcher.EventType-attributes">Attributes<a href="#frequenz.channels.util._file_watcher.FileWatcher.EventType-attributes" class="headerlink" title="Permanent link"></a></h7>

<div class="doc doc-object doc-attribute">



<h8 id="frequenz.channels.util._file_watcher.FileWatcher.EventType.CREATE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">CREATE</span> <span class="o">=</span> <span class="n">Change</span><span class="o">.</span><span class="n">added</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.EventType.CREATE" class="headerlink" title="Permanent link"></a></h8>


  <div class="doc doc-contents ">
  
      <p>A new file was created.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h8 id="frequenz.channels.util._file_watcher.FileWatcher.EventType.DELETE" class="doc doc-heading">
<code class="highlight language-python"><span class="n">DELETE</span> <span class="o">=</span> <span class="n">Change</span><span class="o">.</span><span class="n">deleted</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.EventType.DELETE" class="headerlink" title="Permanent link"></a></h8>


  <div class="doc doc-contents ">
  
      <p>An existing file was deleted.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h8 id="frequenz.channels.util._file_watcher.FileWatcher.EventType.MODIFY" class="doc doc-heading">
<code class="highlight language-python"><span class="n">MODIFY</span> <span class="o">=</span> <span class="n">Change</span><span class="o">.</span><span class="n">modified</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
  </span>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.EventType.MODIFY" class="headerlink" title="Permanent link"></a></h8>


  <div class="doc doc-contents ">
  
      <p>An existing file was modified.</p>
  </div>

</div>





  </div>

  </div>

</div>
<h5 id="frequenz.channels.util.FileWatcher-functions">Functions<a href="#frequenz.channels.util.FileWatcher-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._file_watcher.FileWatcher.__del__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__del__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.__del__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Cleanup registered watches.</p>
<p><code>awatch</code> passes the <code>stop_event</code> to a separate task/thread. This way
<code>awatch</code> getting destroyed properly. The background task will continue
until the signal is received.</p>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_file_watcher.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cleanup registered watches.</span>

<span class="sd">    `awatch` passes the `stop_event` to a separate task/thread. This way</span>
<span class="sd">    `awatch` getting destroyed properly. The background task will continue</span>
<span class="sd">    until the signal is received.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._file_watcher.FileWatcher.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">paths</span><span class="p">,</span> <span class="n">event_types</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">EventType</span><span class="p">))</span></code>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.__init__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>FileWatcher</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>paths</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Paths to watch for changes.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/pathlib.html#module-pathlib">pathlib</a>.<a class="autorefs autorefs-external" title="pathlib.Path" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path">Path</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>event_types</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Types of events to watch for. Defaults to watch for
all event types.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="collections.abc" href="https://docs.python.org/3/library/collections.abc.html#module-collections.abc">abc</a>.<a class="autorefs autorefs-external" title="collections.abc.Iterable" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable">Iterable</a>[<a class="autorefs autorefs-internal" title="frequenz.channels.util._file_watcher.FileWatcher.EventType" href="#frequenz.channels.util._file_watcher.FileWatcher.EventType">EventType</a>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#frozenset">frozenset</a>(<a class="autorefs autorefs-internal" title="frequenz.channels.util._file_watcher.FileWatcher.EventType" href="#frequenz.channels.util._file_watcher.FileWatcher.EventType">EventType</a>)</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_file_watcher.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">paths</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span> <span class="o">|</span> <span class="nb">str</span><span class="p">],</span>
    <span class="n">event_types</span><span class="p">:</span> <span class="n">abc</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">EventType</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">EventType</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a `FileWatcher` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        paths: Paths to watch for changes.</span>
<span class="sd">        event_types: Types of events to watch for. Defaults to watch for</span>
<span class="sd">            all event types.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">event_types</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">[</span><span class="n">FileWatcher</span><span class="o">.</span><span class="n">EventType</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">event_types</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_paths</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">path</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span> <span class="k">else</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span>
    <span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_awatch</span> <span class="o">=</span> <span class="n">awatch</span><span class="p">(</span>
        <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_paths</span><span class="p">,</span> <span class="n">stop_event</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="p">,</span> <span class="n">watch_filter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_events</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_awatch_stopped_exc</span><span class="p">:</span> <span class="ne">Exception</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">FileChange</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._file_watcher.FileWatcher.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.consume" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest event once <code>ready</code> is complete.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._file_watcher.FileWatcher.Event" href="#frequenz.channels.util._file_watcher.FileWatcher.Event">Event</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The next event that was received.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels._exceptions.ReceiverStoppedError" href="../#frequenz.channels.ReceiverStoppedError">ReceiverStoppedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if there is some problem with the receiver.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_file_watcher.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Event</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the latest event once `ready` is complete.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next event that was received.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ReceiverStoppedError: if there is some problem with the receiver.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_awatch_stopped_exc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">self._awatch_stopped_exc</span>

    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">,</span> <span class="s2">&quot;`consume()` must be preceeded by a call to `ready()`&quot;</span>
    <span class="c1"># Tuple of (Change, path) returned by watchfiles</span>
    <span class="n">change</span><span class="p">,</span> <span class="n">path_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">FileWatcher</span><span class="o">.</span><span class="n">Event</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="n">FileWatcher</span><span class="o">.</span><span class="n">EventType</span><span class="p">(</span><span class="n">change</span><span class="p">),</span> <span class="n">path</span><span class="o">=</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">path_str</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._file_watcher.FileWatcher.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.util._file_watcher.FileWatcher.ready" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until the receiver is ready with a value or an error.</p>
<p>Once a call to <code>ready()</code> has finished, the value should be read with
a call to <code>consume()</code> (<code>receive()</code> or iterated over). The receiver will
remain ready (this method will return immediately) until it is
consumed.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether the receiver is still active.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_file_watcher.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value or an error.</span>

<span class="sd">    Once a call to `ready()` has finished, the value should be read with</span>
<span class="sd">    a call to `consume()` (`receive()` or iterated over). The receiver will</span>
<span class="sd">    remain ready (this method will return immediately) until it is</span>
<span class="sd">    consumed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the receiver is still active.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># if it was already stopped, return immediately.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_awatch_stopped_exc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_awatch</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">StopAsyncIteration</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_awatch_stopped_exc</span> <span class="o">=</span> <span class="n">err</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.Merge" class="doc doc-heading">
        <code>frequenz.channels.util.Merge</code>


<a href="#frequenz.channels.util.Merge" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[<span title="frequenz.channels._base_classes.T">T</span>]</code></p>

  
      <p>Merge messages coming from multiple channels into a single stream.</p>

<details class="example" open>
  <summary>Example</summary>
  <p>For example, if there are two channel receivers with the same type,
they can be awaited together, and their results merged into a single
stream, by using <code>Merge</code> like this:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">frequenz.channels</span> <span class="kn">import</span> <span class="n">Broadcast</span>

<span class="n">channel1</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">int</span><span class="p">](</span><span class="s2">&quot;input-chan-1&quot;</span><span class="p">)</span>
<span class="n">channel2</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">int</span><span class="p">](</span><span class="s2">&quot;input-chan-2&quot;</span><span class="p">)</span>
<span class="n">receiver1</span> <span class="o">=</span> <span class="n">channel1</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">()</span>
<span class="n">receiver2</span> <span class="o">=</span> <span class="n">channel2</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">()</span>

<span class="n">merge</span> <span class="o">=</span> <span class="n">Merge</span><span class="p">(</span><span class="n">receiver1</span><span class="p">,</span> <span class="n">receiver2</span><span class="p">)</span>
<span class="k">while</span> <span class="n">msg</span> <span class="o">:=</span> <span class="k">await</span> <span class="n">merge</span><span class="o">.</span><span class="n">receive</span><span class="p">():</span>
    <span class="c1"># do something with msg</span>
    <span class="k">pass</span>
</code></pre></div>
<p>When <code>merge</code> is no longer needed, then it should be stopped using
<code>self.stop()</code> method. This will cleanup any internal pending async tasks.</p>
</details>

        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Merge</span><span class="p">(</span><span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge messages coming from multiple channels into a single stream.</span>

<span class="sd">    Example:</span>
<span class="sd">        For example, if there are two channel receivers with the same type,</span>
<span class="sd">        they can be awaited together, and their results merged into a single</span>
<span class="sd">        stream, by using `Merge` like this:</span>

<span class="sd">        ```python</span>
<span class="sd">        from frequenz.channels import Broadcast</span>

<span class="sd">        channel1 = Broadcast[int](&quot;input-chan-1&quot;)</span>
<span class="sd">        channel2 = Broadcast[int](&quot;input-chan-2&quot;)</span>
<span class="sd">        receiver1 = channel1.new_receiver()</span>
<span class="sd">        receiver2 = channel2.new_receiver()</span>

<span class="sd">        merge = Merge(receiver1, receiver2)</span>
<span class="sd">        while msg := await merge.receive():</span>
<span class="sd">            # do something with msg</span>
<span class="sd">            pass</span>
<span class="sd">        ```</span>

<span class="sd">        When `merge` is no longer needed, then it should be stopped using</span>
<span class="sd">        `self.stop()` method. This will cleanup any internal pending async tasks.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a `Merge` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: sequence of channel receivers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span> <span class="n">recv</span> <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="o">.</span><span class="n">done</span><span class="p">()</span> <span class="ow">and</span> <span class="n">task</span><span class="o">.</span><span class="n">get_loop</span><span class="p">()</span><span class="o">.</span><span class="n">is_running</span><span class="p">():</span>
                <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the `Merge` instance and cleanup any pending tasks.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value or an error.</span>

<span class="sd">        Once a call to `ready()` has finished, the value should be read with</span>
<span class="sd">        a call to `consume()` (`receive()` or iterated over). The receiver will</span>
<span class="sd">        remain ready (this method will return immediately) until it is</span>
<span class="sd">        consumed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the receiver is still active.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># we use a while loop to continue to wait for new data, in case the</span>
        <span class="c1"># previous `wait` completed because a channel was closed.</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="c1"># if there are no more pending receivers, we return immediately.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
                <span class="c1"># if channel is closed, don&#39;t add a task for it again.</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="ne">StopAsyncIteration</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                    <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
                    <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next value that was received.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ReceiverStoppedError: if the receiver stopped producing messages.</span>
<span class="sd">            ReceiverError: if there is some problem with the receiver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span> <span class="s2">&quot;`consume()` must be preceeded by a call to `ready()`&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.util.Merge-functions">Functions<a href="#frequenz.channels.util.Merge-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge.Merge.__del__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__del__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._merge.Merge.__del__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Cleanup any pending tasks.</p>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="o">.</span><span class="n">done</span><span class="p">()</span> <span class="ow">and</span> <span class="n">task</span><span class="o">.</span><span class="n">get_loop</span><span class="p">()</span><span class="o">.</span><span class="n">is_running</span><span class="p">():</span>
            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge.Merge.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

<a href="#frequenz.channels.util._merge.Merge.__init__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>Merge</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>*args</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>sequence of channel receivers.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[<span title="frequenz.channels._base_classes.T">T</span>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>()</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a `Merge` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        *args: sequence of channel receivers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span> <span class="n">recv</span> <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">)}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge.Merge.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._merge.Merge.consume" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest value once <code>ready</code> is complete.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="frequenz.channels._base_classes.T">T</span></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The next value that was received.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels._exceptions.ReceiverStoppedError" href="../#frequenz.channels.ReceiverStoppedError">ReceiverStoppedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if the receiver stopped producing messages.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels._exceptions.ReceiverError" href="../#frequenz.channels.ReceiverError">ReceiverError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if there is some problem with the receiver.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next value that was received.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ReceiverStoppedError: if the receiver stopped producing messages.</span>
<span class="sd">        ReceiverError: if there is some problem with the receiver.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span> <span class="s2">&quot;`consume()` must be preceeded by a call to `ready()`&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge.Merge.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.util._merge.Merge.ready" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until the receiver is ready with a value or an error.</p>
<p>Once a call to <code>ready()</code> has finished, the value should be read with
a call to <code>consume()</code> (<code>receive()</code> or iterated over). The receiver will
remain ready (this method will return immediately) until it is
consumed.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether the receiver is still active.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value or an error.</span>

<span class="sd">    Once a call to `ready()` has finished, the value should be read with</span>
<span class="sd">    a call to `consume()` (`receive()` or iterated over). The receiver will</span>
<span class="sd">    remain ready (this method will return immediately) until it is</span>
<span class="sd">    consumed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the receiver is still active.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># we use a while loop to continue to wait for new data, in case the</span>
    <span class="c1"># previous `wait` completed because a channel was closed.</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># if there are no more pending receivers, we return immediately.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
            <span class="c1"># if channel is closed, don&#39;t add a task for it again.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="ne">StopAsyncIteration</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge.Merge.stop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stop</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.util._merge.Merge.stop" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Stop the <code>Merge</code> instance and cleanup any pending tasks.</p>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop the `Merge` instance and cleanup any pending tasks.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
        <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.MergeNamed" class="doc doc-heading">
        <code>frequenz.channels.util.MergeNamed</code>


<a href="#frequenz.channels.util.MergeNamed" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[<a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="frequenz.channels._base_classes.T">T</span>]]</code></p>

  
      <p>Merge messages coming from multiple named channels into a single stream.</p>
<p>When <code>MergeNamed</code> is no longer needed, then it should be stopped using
<code>self.stop()</code> method. This will cleanup any internal pending async tasks.</p>


        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge_named.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MergeNamed</span><span class="p">(</span><span class="n">Receiver</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge messages coming from multiple named channels into a single stream.</span>

<span class="sd">    When `MergeNamed` is no longer needed, then it should be stopped using</span>
<span class="sd">    `self.stop()` method. This will cleanup any internal pending async tasks.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a `MergeNamed` instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs: sequence of channel receivers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="o">.</span><span class="n">done</span><span class="p">()</span> <span class="ow">and</span> <span class="n">task</span><span class="o">.</span><span class="n">get_loop</span><span class="p">()</span><span class="o">.</span><span class="n">is_running</span><span class="p">():</span>
                <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the `MergeNamed` instance and cleanup any pending tasks.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value or an error.</span>

<span class="sd">        Once a call to `ready()` has finished, the value should be read with</span>
<span class="sd">        a call to `consume()` (`receive()` or iterated over). The receiver will</span>
<span class="sd">        remain ready (this method will return immediately) until it is</span>
<span class="sd">        consumed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the receiver is still active.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># we use a while loop to continue to wait for new data, in case the</span>
        <span class="c1"># previous `wait` completed because a channel was closed.</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="c1"># if there are no more pending receivers, we return immediately.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
                <span class="c1"># if channel is closed, don&#39;t add a task for it again.</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="ne">StopAsyncIteration</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                    <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
                    <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
                <span class="p">)</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next key, value that was received.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ReceiverStoppedError: if the receiver stopped producing messages.</span>
<span class="sd">            ReceiverError: if there is some problem with the receiver.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span> <span class="s2">&quot;`consume()` must be preceeded by a call to `ready()`&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.util.MergeNamed-functions">Functions<a href="#frequenz.channels.util.MergeNamed-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge_named.MergeNamed.__del__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__del__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._merge_named.MergeNamed.__del__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Cleanup any pending tasks.</p>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge_named.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cleanup any pending tasks.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="o">.</span><span class="n">done</span><span class="p">()</span> <span class="ow">and</span> <span class="n">task</span><span class="o">.</span><span class="n">get_loop</span><span class="p">()</span><span class="o">.</span><span class="n">is_running</span><span class="p">():</span>
            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge_named.MergeNamed.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#frequenz.channels.util._merge_named.MergeNamed.__init__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a <code>MergeNamed</code> instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>**kwargs</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>sequence of channel receivers.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[<span title="frequenz.channels._base_classes.T">T</span>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>{}</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge_named.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a `MergeNamed` instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs: sequence of channel receivers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span> <span class="o">=</span> <span class="n">kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">:</span> <span class="n">Deque</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge_named.MergeNamed.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._merge_named.MergeNamed.consume" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest value once <code>ready</code> is complete.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="frequenz.channels._base_classes.T">T</span>]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The next key, value that was received.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels._exceptions.ReceiverStoppedError" href="../#frequenz.channels.ReceiverStoppedError">ReceiverStoppedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if the receiver stopped producing messages.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels._exceptions.ReceiverError" href="../#frequenz.channels.ReceiverError">ReceiverError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if there is some problem with the receiver.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge_named.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">T</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the latest value once `ready` is complete.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next key, value that was received.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ReceiverStoppedError: if the receiver stopped producing messages.</span>
<span class="sd">        ReceiverError: if there is some problem with the receiver.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">,</span> <span class="s2">&quot;`consume()` must be preceeded by a call to `ready()`&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge_named.MergeNamed.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.util._merge_named.MergeNamed.ready" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until the receiver is ready with a value or an error.</p>
<p>Once a call to <code>ready()</code> has finished, the value should be read with
a call to <code>consume()</code> (<code>receive()</code> or iterated over). The receiver will
remain ready (this method will return immediately) until it is
consumed.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether the receiver is still active.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge_named.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait until the receiver is ready with a value or an error.</span>

<span class="sd">    Once a call to `ready()` has finished, the value should be read with</span>
<span class="sd">    a call to `consume()` (`receive()` or iterated over). The receiver will</span>
<span class="sd">    remain ready (this method will return immediately) until it is</span>
<span class="sd">    consumed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the receiver is still active.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># we use a while loop to continue to wait for new data, in case the</span>
    <span class="c1"># previous `wait` completed because a channel was closed.</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># if there are messages waiting to be consumed, return immediately.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># if there are no more pending receivers, we return immediately.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">done</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
            <span class="c1"># if channel is closed, don&#39;t add a task for it again.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">exception</span><span class="p">(),</span> <span class="ne">StopAsyncIteration</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
                <span class="c1"># pylint: disable=unnecessary-dunder-call</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receivers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="fm">__anext__</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._merge_named.MergeNamed.stop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stop</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.util._merge_named.MergeNamed.stop" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Stop the <code>MergeNamed</code> instance and cleanup any pending tasks.</p>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_merge_named.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop the `MergeNamed` instance and cleanup any pending tasks.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">:</span>
        <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.MissedTickPolicy" class="doc doc-heading">
        <code>frequenz.channels.util.MissedTickPolicy</code>


<a href="#frequenz.channels.util.MissedTickPolicy" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/abc.html#module-abc">abc</a>.<a class="autorefs autorefs-external" title="abc.ABC" href="https://docs.python.org/3/library/abc.html#abc.ABC">ABC</a></code></p>

  
      <p>A policy to handle timer missed ticks.</p>
<p>This is only relevant if the timer is not ready to trigger when it should
(an interval passed) which can happen if the event loop is busy processing
other tasks.</p>


        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MissedTickPolicy</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A policy to handle timer missed ticks.</span>

<span class="sd">    This is only relevant if the timer is not ready to trigger when it should</span>
<span class="sd">    (an interval passed) which can happen if the event loop is busy processing</span>
<span class="sd">    other tasks.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">calculate_next_tick_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">now</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the next tick time according to `missed_tick_policy`.</span>

<span class="sd">        This method is called by `ready()` after it has determined that the</span>
<span class="sd">        timer has triggered.  It will check if the timer has missed any ticks</span>
<span class="sd">        and handle them according to `missed_tick_policy`.</span>

<span class="sd">        Args:</span>
<span class="sd">            interval: The interval between ticks (in microseconds).</span>
<span class="sd">            scheduled_tick_time: The time the current tick was scheduled to</span>
<span class="sd">                trigger (in microseconds).</span>
<span class="sd">            now: The current loop time (in microseconds).</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next tick time (in microseconds) according to</span>
<span class="sd">                `missed_tick_policy`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># dummy value to avoid darglint warnings</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of the instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The string representation of the instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">()&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.util.MissedTickPolicy-functions">Functions<a href="#frequenz.channels.util.MissedTickPolicy-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.MissedTickPolicy.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._timer.MissedTickPolicy.__repr__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a string representation of the instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The string representation of the instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of the instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The string representation of the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">()&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.MissedTickPolicy.calculate_next_tick_time" class="doc doc-heading">
<code class="highlight language-python"><span class="n">calculate_next_tick_time</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">,</span> <span class="n">now</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#frequenz.channels.util._timer.MissedTickPolicy.calculate_next_tick_time" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Calculate the next tick time according to <code>missed_tick_policy</code>.</p>
<p>This method is called by <code>ready()</code> after it has determined that the
timer has triggered.  It will check if the timer has missed any ticks
and handle them according to <code>missed_tick_policy</code>.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>interval</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The interval between ticks (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>scheduled_tick_time</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The time the current tick was scheduled to
trigger (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>now</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The current loop time (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The next tick time (in microseconds) according to
<code>missed_tick_policy</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="nf">calculate_next_tick_time</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">now</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the next tick time according to `missed_tick_policy`.</span>

<span class="sd">    This method is called by `ready()` after it has determined that the</span>
<span class="sd">    timer has triggered.  It will check if the timer has missed any ticks</span>
<span class="sd">    and handle them according to `missed_tick_policy`.</span>

<span class="sd">    Args:</span>
<span class="sd">        interval: The interval between ticks (in microseconds).</span>
<span class="sd">        scheduled_tick_time: The time the current tick was scheduled to</span>
<span class="sd">            trigger (in microseconds).</span>
<span class="sd">        now: The current loop time (in microseconds).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next tick time (in microseconds) according to</span>
<span class="sd">            `missed_tick_policy`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># dummy value to avoid darglint warnings</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.SelectError" class="doc doc-heading">
        <code>frequenz.channels.util.SelectError</code>


<a href="#frequenz.channels.util.SelectError" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#BaseException">BaseException</a></code></p>

  
      <p>A base exception for <a class="autorefs autorefs-internal" href="#frequenz.channels.util.select"><code>select()</code></a>.</p>
<p>This exception is raised when a <code>select()</code> iteration fails.  It is raised as
a single exception when one receiver fails during normal operation (while calling
<code>ready()</code> for example).  It is raised as a group exception
(<a class="autorefs autorefs-internal" href="#frequenz.channels.util.SelectErrorGroup"><code>SelectErrorGroup</code></a>) when a <code>select</code> loop
is cleaning up after it's done.</p>


        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SelectError</span><span class="p">(</span><span class="ne">BaseException</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A base exception for [`select()`][frequenz.channels.util.select].</span>

<span class="sd">    This exception is raised when a `select()` iteration fails.  It is raised as</span>
<span class="sd">    a single exception when one receiver fails during normal operation (while calling</span>
<span class="sd">    `ready()` for example).  It is raised as a group exception</span>
<span class="sd">    ([`SelectErrorGroup`][frequenz.channels.util.SelectErrorGroup]) when a `select` loop</span>
<span class="sd">    is cleaning up after it&#39;s done.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.SelectErrorGroup" class="doc doc-heading">
        <code>frequenz.channels.util.SelectErrorGroup</code>


<a href="#frequenz.channels.util.SelectErrorGroup" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#BaseExceptionGroup">BaseExceptionGroup</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#BaseException">BaseException</a>]</code>, <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._select.SelectError" href="#frequenz.channels.util.SelectError">SelectError</a></code></p>

  
      <p>An exception group for <a class="autorefs autorefs-internal" href="#frequenz.channels.util.select"><code>select()</code></a> operation.</p>
<p>This exception group is raised when a <code>select()</code> loops fails while cleaning up
runing tasts to check for ready receivers.</p>


        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SelectErrorGroup</span><span class="p">(</span><span class="n">BaseExceptionGroup</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span> <span class="n">SelectError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An exception group for [`select()`][frequenz.channels.util.select] operation.</span>

<span class="sd">    This exception group is raised when a `select()` loops fails while cleaning up</span>
<span class="sd">    runing tasts to check for ready receivers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.Selected" class="doc doc-heading">
        <code>frequenz.channels.util.Selected</code>


<a href="#frequenz.channels.util.Selected" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="frequenz.channels.util._select._T">_T</span>]</code></p>

  
      <p>A result of a <a class="autorefs autorefs-internal" href="#frequenz.channels.util.select"><code>select()</code></a> iteration.</p>
<p>The selected receiver is consumed immediately and the received value is stored in
the instance, unless there was an exception while receiving the value, in which case
the exception is stored instead.</p>
<p><code>Selected</code> instances should be used in conjunction with the
<a class="autorefs autorefs-internal" href="#frequenz.channels.util.selected_from"><code>selected_from()</code></a> function to determine
which receiver was selected.</p>
<p>Please see <a class="autorefs autorefs-internal" href="#frequenz.channels.util.select"><code>select()</code></a> for an example.</p>


        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Selected</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A result of a [`select()`][frequenz.channels.util.select] iteration.</span>

<span class="sd">    The selected receiver is consumed immediately and the received value is stored in</span>
<span class="sd">    the instance, unless there was an exception while receiving the value, in which case</span>
<span class="sd">    the exception is stored instead.</span>

<span class="sd">    `Selected` instances should be used in conjunction with the</span>
<span class="sd">    [`selected_from()`][frequenz.channels.util.selected_from] function to determine</span>
<span class="sd">    which receiver was selected.</span>

<span class="sd">    Please see [`select()`][frequenz.channels.util.select] for an example.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">class</span> <span class="nc">_EmptyResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A sentinel value to distinguish between None and empty result.</span>

<span class="sd">        We need a sentinel because a result can also be `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&lt;empty&gt;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receiver</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new instance.</span>

<span class="sd">        The receiver is consumed immediately when creating the instance and the received</span>
<span class="sd">        value is stored in the instance for later use as</span>
<span class="sd">        [`value`][frequenz.channels.util.Selected.value].  If there was an exception</span>
<span class="sd">        while receiving the value, then the exception is stored in the instance instead</span>
<span class="sd">        (as [`exception`][frequenz.channels.util.Selected.exception]).</span>

<span class="sd">        Args:</span>
<span class="sd">            receiver: The receiver that was selected.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_recv</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">_T</span><span class="p">]</span> <span class="o">=</span> <span class="n">receiver</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The receiver that was selected.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">_T</span> <span class="o">|</span> <span class="n">Selected</span><span class="o">.</span><span class="n">_EmptyResult</span> <span class="o">=</span> <span class="n">Selected</span><span class="o">.</span><span class="n">_EmptyResult</span><span class="p">()</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The value that was received.</span>

<span class="sd">        If there was an exception while receiving the value, then this will be `None`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="p">:</span> <span class="ne">Exception</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The exception that was raised while receiving the value (if any).&quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">consume</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># pylint: disable=broad-except</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span> <span class="o">=</span> <span class="n">exc</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_handled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Flag to indicate if this selected has been handled in the if-chain.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The value that was received, if any.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The value that was received.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If there was an exception while receiving the value. Normally</span>
<span class="sd">                this should be an [`frequenz.channels.Error`][frequenz.channels.Error]</span>
<span class="sd">                instance, but catches all exceptions in case some receivers can raise</span>
<span class="sd">                anything else.</span>

<span class="sd">        # noqa: DAR401 _exception</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">,</span> <span class="n">Selected</span><span class="o">.</span><span class="n">_EmptyResult</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exception</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="ne">Exception</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The exception that was raised while receiving the value (if any).</span>

<span class="sd">        Returns:</span>
<span class="sd">            The exception that was raised while receiving the value (if any).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span>

    <span class="k">def</span> <span class="nf">was_stopped</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the selected receiver was stopped.</span>

<span class="sd">        Check if the selected receiver raised</span>
<span class="sd">        a [`ReceiverStoppedError`][frequenz.channels.ReceiverStoppedError] while</span>
<span class="sd">        consuming a value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the receiver was stopped.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="p">,</span> <span class="n">ReceiverStoppedError</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of this instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string representation of this instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_recv</span><span class="si">}</span><span class="s2">) -&gt; &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a the internal representation of this instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A string representation of this instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_recv</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="si">=}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_handled</span><span class="si">=}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">





<h5 id="frequenz.channels.util.Selected-attributes">Attributes<a href="#frequenz.channels.util.Selected-attributes" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._select.Selected.exception" class="doc doc-heading">
<code class="highlight language-python"><span class="n">exception</span><span class="p">:</span> <span class="ne">Exception</span> <span class="o">|</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._select.Selected.exception" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>The exception that was raised while receiving the value (if any).</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#Exception">Exception</a> | None</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The exception that was raised while receiving the value (if any).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._select.Selected.value" class="doc doc-heading">
<code class="highlight language-python"><span class="n">value</span><span class="p">:</span> <span class="n">_T</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._select.Selected.value" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>The value that was received, if any.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><span title="frequenz.channels.util._select._T">_T</span></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The value that was received.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#Exception">Exception</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>If there was an exception while receiving the value. Normally
this should be an <a class="autorefs autorefs-internal" href="../#frequenz.channels.Error"><code>frequenz.channels.Error</code></a>
instance, but catches all exceptions in case some receivers can raise
anything else.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <h6 id="frequenz.channels.util._select.Selected.value--noqa-dar401-_exception">noqa: DAR401 _exception<a class="headerlink" href="#frequenz.channels.util._select.Selected.value--noqa-dar401-_exception" title="Permanent link"></a></h6>
  </div>

</div>

<h5 id="frequenz.channels.util.Selected-functions">Functions<a href="#frequenz.channels.util.Selected-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._select.Selected.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">receiver</span><span class="p">)</span></code>

<a href="#frequenz.channels.util._select.Selected.__init__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a new instance.</p>
<p>The receiver is consumed immediately when creating the instance and the received
value is stored in the instance for later use as
<a class="autorefs autorefs-internal" href="#frequenz.channels.util._select.Selected.value"><code>value</code></a>.  If there was an exception
while receiving the value, then the exception is stored in the instance instead
(as <a class="autorefs autorefs-internal" href="#frequenz.channels.util._select.Selected.exception"><code>exception</code></a>).</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>receiver</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The receiver that was selected.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[<span title="frequenz.channels.util._select._T">_T</span>]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receiver</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new instance.</span>

<span class="sd">    The receiver is consumed immediately when creating the instance and the received</span>
<span class="sd">    value is stored in the instance for later use as</span>
<span class="sd">    [`value`][frequenz.channels.util.Selected.value].  If there was an exception</span>
<span class="sd">    while receiving the value, then the exception is stored in the instance instead</span>
<span class="sd">    (as [`exception`][frequenz.channels.util.Selected.exception]).</span>

<span class="sd">    Args:</span>
<span class="sd">        receiver: The receiver that was selected.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_recv</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">_T</span><span class="p">]</span> <span class="o">=</span> <span class="n">receiver</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The receiver that was selected.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="p">:</span> <span class="n">_T</span> <span class="o">|</span> <span class="n">Selected</span><span class="o">.</span><span class="n">_EmptyResult</span> <span class="o">=</span> <span class="n">Selected</span><span class="o">.</span><span class="n">_EmptyResult</span><span class="p">()</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The value that was received.</span>

<span class="sd">    If there was an exception while receiving the value, then this will be `None`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="p">:</span> <span class="ne">Exception</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The exception that was raised while receiving the value (if any).&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_value</span> <span class="o">=</span> <span class="n">receiver</span><span class="o">.</span><span class="n">consume</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># pylint: disable=broad-except</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exception</span> <span class="o">=</span> <span class="n">exc</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_handled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Flag to indicate if this selected has been handled in the if-chain.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._select.Selected.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._select.Selected.__repr__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a the internal representation of this instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A string representation of this instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a the internal representation of this instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A string representation of this instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_recv</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="si">=}</span><span class="s2">, &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_handled</span><span class="si">=}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._select.Selected.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._select.Selected.__str__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a string representation of this instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>A string representation of this instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of this instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A string representation of this instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_recv</span><span class="si">}</span><span class="s2">) -&gt; &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_value</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._select.Selected.was_stopped" class="doc doc-heading">
<code class="highlight language-python"><span class="n">was_stopped</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._select.Selected.was_stopped" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Check if the selected receiver was stopped.</p>
<p>Check if the selected receiver raised
a <a class="autorefs autorefs-internal" href="../#frequenz.channels.ReceiverStoppedError"><code>ReceiverStoppedError</code></a> while
consuming a value.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether the receiver was stopped.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">was_stopped</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the selected receiver was stopped.</span>

<span class="sd">    Check if the selected receiver raised</span>
<span class="sd">    a [`ReceiverStoppedError`][frequenz.channels.ReceiverStoppedError] while</span>
<span class="sd">    consuming a value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the receiver was stopped.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_exception</span><span class="p">,</span> <span class="n">ReceiverStoppedError</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.SkipMissedAndDrift" class="doc doc-heading">
        <code>frequenz.channels.util.SkipMissedAndDrift</code>


<a href="#frequenz.channels.util.SkipMissedAndDrift" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._timer.MissedTickPolicy" href="#frequenz.channels.util.MissedTickPolicy">MissedTickPolicy</a></code></p>

  
      <p>A policy that drops all the missed ticks, triggers immediately and resets.</p>
<p>This will behave effectively as if the timer was <code>reset()</code> at the time it
had triggered last, so the start time will change (and the drift will be
accumulated each time a tick is delayed, but only the relative drift will
be returned on each tick).</p>
<p>The reset happens only if the delay is larger than <code>delay_tolerance</code>, so
it is possible to ignore small delays and not drift in those cases.</p>

<details class="example" open>
  <summary>Example</summary>
  <p>Assume a timer with interval 1 second and <code>delay_tolerance=0.1</code>, the
first tick, <code>T0</code>, happens exactly at time 0, the second tick, <code>T1</code>,
happens at time 1.2 (0.2 seconds late), so the timer triggers
immmediately but drifts a bit. The next tick, <code>T2.2</code>, happens at 2.3 seconds
(0.1 seconds late), so it also triggers immediately but it doesn't
drift because the delay is under the <code>delay_tolerance</code>. The next tick,
<code>T3.2</code>, triggers at 4.3 seconds (1.1 seconds late), so it also triggers
immediately but the timer drifts by 1.1 seconds and the tick <code>T4.2</code> is
skipped (not triggered). The next tick, <code>T5.3</code>, triggers at 5.3 seconds
so is right on time (no drift) and the same happens for tick <code>T6.3</code>,
which triggers at 6.3 seconds.</p>
<div class="highlight"><pre><span></span><code>0         1         2         3         4         5         6
o---------|-o-------|--o------|---------|--o------|--o------|--o--&gt; time
T0          T1         T2.2                T3.2      T5.3      T6.3
</code></pre></div>
</details>

        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SkipMissedAndDrift</span><span class="p">(</span><span class="n">MissedTickPolicy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A policy that drops all the missed ticks, triggers immediately and resets.</span>

<span class="sd">    This will behave effectively as if the timer was `reset()` at the time it</span>
<span class="sd">    had triggered last, so the start time will change (and the drift will be</span>
<span class="sd">    accumulated each time a tick is delayed, but only the relative drift will</span>
<span class="sd">    be returned on each tick).</span>

<span class="sd">    The reset happens only if the delay is larger than `delay_tolerance`, so</span>
<span class="sd">    it is possible to ignore small delays and not drift in those cases.</span>

<span class="sd">    Example:</span>
<span class="sd">        Assume a timer with interval 1 second and `delay_tolerance=0.1`, the</span>
<span class="sd">        first tick, `T0`, happens exactly at time 0, the second tick, `T1`,</span>
<span class="sd">        happens at time 1.2 (0.2 seconds late), so the timer triggers</span>
<span class="sd">        immmediately but drifts a bit. The next tick, `T2.2`, happens at 2.3 seconds</span>
<span class="sd">        (0.1 seconds late), so it also triggers immediately but it doesn&#39;t</span>
<span class="sd">        drift because the delay is under the `delay_tolerance`. The next tick,</span>
<span class="sd">        `T3.2`, triggers at 4.3 seconds (1.1 seconds late), so it also triggers</span>
<span class="sd">        immediately but the timer drifts by 1.1 seconds and the tick `T4.2` is</span>
<span class="sd">        skipped (not triggered). The next tick, `T5.3`, triggers at 5.3 seconds</span>
<span class="sd">        so is right on time (no drift) and the same happens for tick `T6.3`,</span>
<span class="sd">        which triggers at 6.3 seconds.</span>

<span class="sd">        ```</span>
<span class="sd">        0         1         2         3         4         5         6</span>
<span class="sd">        o---------|-o-------|--o------|---------|--o------|--o------|--o--&gt; time</span>
<span class="sd">        T0          T1         T2.2                T3.2      T5.3      T6.3</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">delay_tolerance</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an instance.</span>

<span class="sd">        See the class documenation for more details.</span>

<span class="sd">        Args:</span>
<span class="sd">            delay_tolerance: The maximum delay that is tolerated before</span>
<span class="sd">                starting to drift.  If a tick is delayed less than this, then</span>
<span class="sd">                it is not considered a missed tick and the timer doesn&#39;t</span>
<span class="sd">                accumulate this drift.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `delay_tolerance` is negative.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">_to_microseconds</span><span class="p">(</span><span class="n">delay_tolerance</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The maximum allowed delay before starting to drift.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;delay_tolerance must be positive&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">delay_tolerance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">timedelta</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the maximum delay that is tolerated before starting to drift.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The maximum delay that is tolerated before starting to drift.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">microseconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">calculate_next_tick_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">now</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the next tick time.</span>

<span class="sd">        If the drift is larger than `delay_tolerance`, then it returns `now +</span>
<span class="sd">        interval` (so the timer drifts), otherwise it returns</span>
<span class="sd">        `scheduled_tick_time + interval` (we consider the delay too small and</span>
<span class="sd">        avoid small drifts).</span>

<span class="sd">        Args:</span>
<span class="sd">            now: The current loop time (in microseconds).</span>
<span class="sd">            scheduled_tick_time: The time the current tick was scheduled to</span>
<span class="sd">                trigger (in microseconds).</span>
<span class="sd">            interval: The interval between ticks (in microseconds).</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next tick time (in microseconds).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">drift</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">scheduled_tick_time</span>
        <span class="k">if</span> <span class="n">drift</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">now</span> <span class="o">+</span> <span class="n">interval</span>
        <span class="k">return</span> <span class="n">scheduled_tick_time</span> <span class="o">+</span> <span class="n">interval</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of the instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The string representation of the instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">delay_tolerance</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of the instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The string representation of the instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">delay_tolerance</span><span class="si">=}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">





<h5 id="frequenz.channels.util.SkipMissedAndDrift-attributes">Attributes<a href="#frequenz.channels.util.SkipMissedAndDrift-attributes" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._timer.SkipMissedAndDrift.delay_tolerance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">delay_tolerance</span><span class="p">:</span> <span class="n">timedelta</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._timer.SkipMissedAndDrift.delay_tolerance" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the maximum delay that is tolerated before starting to drift.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="datetime.timedelta" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The maximum delay that is tolerated before starting to drift.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<h5 id="frequenz.channels.util.SkipMissedAndDrift-functions">Functions<a href="#frequenz.channels.util.SkipMissedAndDrift-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.SkipMissedAndDrift.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">delay_tolerance</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span></code>

<a href="#frequenz.channels.util._timer.SkipMissedAndDrift.__init__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create an instance.</p>
<p>See the class documenation for more details.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>delay_tolerance</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The maximum delay that is tolerated before
starting to drift.  If a tick is delayed less than this, then
it is not considered a missed tick and the timer doesn't
accumulate this drift.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="datetime.timedelta" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code><a class="autorefs autorefs-external" title="datetime.timedelta" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a>(0)</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>If <code>delay_tolerance</code> is negative.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">delay_tolerance</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an instance.</span>

<span class="sd">    See the class documenation for more details.</span>

<span class="sd">    Args:</span>
<span class="sd">        delay_tolerance: The maximum delay that is tolerated before</span>
<span class="sd">            starting to drift.  If a tick is delayed less than this, then</span>
<span class="sd">            it is not considered a missed tick and the timer doesn&#39;t</span>
<span class="sd">            accumulate this drift.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `delay_tolerance` is negative.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">_to_microseconds</span><span class="p">(</span><span class="n">delay_tolerance</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The maximum allowed delay before starting to drift.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;delay_tolerance must be positive&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.SkipMissedAndDrift.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._timer.SkipMissedAndDrift.__repr__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a string representation of the instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The string representation of the instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of the instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The string representation of the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">delay_tolerance</span><span class="si">=}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.SkipMissedAndDrift.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._timer.SkipMissedAndDrift.__str__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a string representation of the instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The string representation of the instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of the instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The string representation of the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">delay_tolerance</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.SkipMissedAndDrift.calculate_next_tick_time" class="doc doc-heading">
<code class="highlight language-python"><span class="n">calculate_next_tick_time</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">now</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span></code>

<a href="#frequenz.channels.util._timer.SkipMissedAndDrift.calculate_next_tick_time" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Calculate the next tick time.</p>
<p>If the drift is larger than <code>delay_tolerance</code>, then it returns <code>now +
interval</code> (so the timer drifts), otherwise it returns
<code>scheduled_tick_time + interval</code> (we consider the delay too small and
avoid small drifts).</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>now</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The current loop time (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>scheduled_tick_time</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The time the current tick was scheduled to
trigger (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The interval between ticks (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The next tick time (in microseconds).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_next_tick_time</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">now</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the next tick time.</span>

<span class="sd">    If the drift is larger than `delay_tolerance`, then it returns `now +</span>
<span class="sd">    interval` (so the timer drifts), otherwise it returns</span>
<span class="sd">    `scheduled_tick_time + interval` (we consider the delay too small and</span>
<span class="sd">    avoid small drifts).</span>

<span class="sd">    Args:</span>
<span class="sd">        now: The current loop time (in microseconds).</span>
<span class="sd">        scheduled_tick_time: The time the current tick was scheduled to</span>
<span class="sd">            trigger (in microseconds).</span>
<span class="sd">        interval: The interval between ticks (in microseconds).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next tick time (in microseconds).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">drift</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">scheduled_tick_time</span>
    <span class="k">if</span> <span class="n">drift</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">now</span> <span class="o">+</span> <span class="n">interval</span>
    <span class="k">return</span> <span class="n">scheduled_tick_time</span> <span class="o">+</span> <span class="n">interval</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.SkipMissedAndResync" class="doc doc-heading">
        <code>frequenz.channels.util.SkipMissedAndResync</code>


<a href="#frequenz.channels.util.SkipMissedAndResync" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._timer.MissedTickPolicy" href="#frequenz.channels.util.MissedTickPolicy">MissedTickPolicy</a></code></p>

  
      <p>A policy that drops all the missed ticks, triggers immediately and resyncs.</p>
<p>If ticks are missed, the timer will trigger immediately returing the drift
and it will schedule to trigger again on the next multiple of <code>interval</code>,
effectively skipping any missed ticks, but resyncing with the original start
time.</p>

<details class="example" open>
  <summary>Example</summary>
  <p>Assume a timer with interval 1 second, the tick <code>T0</code> happens exactly
at time 0, the second tick, <code>T1</code>, happens at time 1.2 (0.2 seconds
late), so it trigges immediately.  The third tick, <code>T2</code>, happens at
time 2.3 (0.3 seconds late), so it also triggers immediately.  The
fourth tick, <code>T3</code>, happens at time 4.3 (1.3 seconds late), so it also
triggers immediately but the fifth tick, <code>T4</code>, which was also
already delayed (by 0.3 seconds) is skipped.  The sixth tick,
<code>T5</code>, happens at 5.1 (0.1 seconds late), so it triggers immediately
again. The seventh tick, <code>T6</code>, happens at 6.0, right on time.</p>
<div class="highlight"><pre><span></span><code>0         1         2         3         4  o      5         6
o---------|-o-------|--o------|---------|--o------|o--------o-----&gt; time
T0          T1         T2                  T3      T5       T6
</code></pre></div>
</details>

        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SkipMissedAndResync</span><span class="p">(</span><span class="n">MissedTickPolicy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A policy that drops all the missed ticks, triggers immediately and resyncs.</span>

<span class="sd">    If ticks are missed, the timer will trigger immediately returing the drift</span>
<span class="sd">    and it will schedule to trigger again on the next multiple of `interval`,</span>
<span class="sd">    effectively skipping any missed ticks, but resyncing with the original start</span>
<span class="sd">    time.</span>

<span class="sd">    Example:</span>
<span class="sd">        Assume a timer with interval 1 second, the tick `T0` happens exactly</span>
<span class="sd">        at time 0, the second tick, `T1`, happens at time 1.2 (0.2 seconds</span>
<span class="sd">        late), so it trigges immediately.  The third tick, `T2`, happens at</span>
<span class="sd">        time 2.3 (0.3 seconds late), so it also triggers immediately.  The</span>
<span class="sd">        fourth tick, `T3`, happens at time 4.3 (1.3 seconds late), so it also</span>
<span class="sd">        triggers immediately but the fifth tick, `T4`, which was also</span>
<span class="sd">        already delayed (by 0.3 seconds) is skipped.  The sixth tick,</span>
<span class="sd">        `T5`, happens at 5.1 (0.1 seconds late), so it triggers immediately</span>
<span class="sd">        again. The seventh tick, `T6`, happens at 6.0, right on time.</span>

<span class="sd">        ```</span>
<span class="sd">        0         1         2         3         4  o      5         6</span>
<span class="sd">        o---------|-o-------|--o------|---------|--o------|o--------o-----&gt; time</span>
<span class="sd">        T0          T1         T2                  T3      T5       T6</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">calculate_next_tick_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">now</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the next tick time.</span>

<span class="sd">        Calculate the next multiple of `interval` after `scheduled_tick_time`.</span>

<span class="sd">        Args:</span>
<span class="sd">            now: The current loop time (in microseconds).</span>
<span class="sd">            scheduled_tick_time: The time the current tick was scheduled to</span>
<span class="sd">                trigger (in microseconds).</span>
<span class="sd">            interval: The interval between ticks (in microseconds).</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next tick time (in microseconds).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># We need to resync (align) the next tick time to the current time</span>
        <span class="n">drift</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">scheduled_tick_time</span>
        <span class="n">delta_to_next_tick</span> <span class="o">=</span> <span class="n">interval</span> <span class="o">-</span> <span class="p">(</span><span class="n">drift</span> <span class="o">%</span> <span class="n">interval</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">now</span> <span class="o">+</span> <span class="n">delta_to_next_tick</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.util.SkipMissedAndResync-functions">Functions<a href="#frequenz.channels.util.SkipMissedAndResync-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.SkipMissedAndResync.calculate_next_tick_time" class="doc doc-heading">
<code class="highlight language-python"><span class="n">calculate_next_tick_time</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">now</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span></code>

<a href="#frequenz.channels.util._timer.SkipMissedAndResync.calculate_next_tick_time" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Calculate the next tick time.</p>
<p>Calculate the next multiple of <code>interval</code> after <code>scheduled_tick_time</code>.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>now</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The current loop time (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>scheduled_tick_time</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The time the current tick was scheduled to
trigger (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The interval between ticks (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The next tick time (in microseconds).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_next_tick_time</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">now</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the next tick time.</span>

<span class="sd">    Calculate the next multiple of `interval` after `scheduled_tick_time`.</span>

<span class="sd">    Args:</span>
<span class="sd">        now: The current loop time (in microseconds).</span>
<span class="sd">        scheduled_tick_time: The time the current tick was scheduled to</span>
<span class="sd">            trigger (in microseconds).</span>
<span class="sd">        interval: The interval between ticks (in microseconds).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next tick time (in microseconds).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># We need to resync (align) the next tick time to the current time</span>
    <span class="n">drift</span> <span class="o">=</span> <span class="n">now</span> <span class="o">-</span> <span class="n">scheduled_tick_time</span>
    <span class="n">delta_to_next_tick</span> <span class="o">=</span> <span class="n">interval</span> <span class="o">-</span> <span class="p">(</span><span class="n">drift</span> <span class="o">%</span> <span class="n">interval</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">now</span> <span class="o">+</span> <span class="n">delta_to_next_tick</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.Timer" class="doc doc-heading">
        <code>frequenz.channels.util.Timer</code>


<a href="#frequenz.channels.util.Timer" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[<a class="autorefs autorefs-external" title="datetime.timedelta" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a>]</code></p>

  
      <p>A timer receiver that triggers every <code>interval</code> time.</p>
<p>The timer has microseconds resolution, so the
<a class="autorefs autorefs-internal" href="#frequenz.channels.util._timer.Timer.interval"><code>interval</code></a> must be at least
1 microsecond.</p>
<p>The message it produces is a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta"><code>timedelta</code></a> containing the drift
of the timer, i.e. the difference between when the timer should have triggered and
the time when it actually triggered.</p>
<p>This drift will likely never be <code>0</code>, because if there is a task that is
running when it should trigger, the timer will be delayed. In this case the
drift will be positive. A negative drift should be technically impossible,
as the timer uses <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio.html#module-asyncio"><code>asyncio</code></a>s loop monotonic clock.</p>
<p>If the timer is delayed too much, then it will behave according to the
<a class="autorefs autorefs-internal" href="#frequenz.channels.util._timer.Timer.missed_tick_policy"><code>missed_tick_policy</code></a>. Missing
ticks might or might not trigger a message and the drift could be accumulated or not
depending on the chosen policy.</p>
<p>These are the currently built-in available policies:</p>
<ul>
<li><a class="autorefs autorefs-internal" href="#frequenz.channels.util.SkipMissedAndDrift"><code>SkipMissedAndDrift</code></a></li>
<li><a class="autorefs autorefs-internal" href="#frequenz.channels.util.SkipMissedAndResync"><code>SkipMissedAndResync</code></a></li>
<li><a class="autorefs autorefs-internal" href="#frequenz.channels.util.TriggerAllMissed"><code>TriggerAllMissed</code></a></li>
</ul>
<p>For the most common cases, a specialized constructor is provided:</p>
<ul>
<li><a class="autorefs autorefs-internal" href="#frequenz.channels.util._timer.Timer.periodic"><code>periodic()</code></a> (uses the
  <a class="autorefs autorefs-internal" href="#frequenz.channels.util.TriggerAllMissed"><code>TriggerAllMissed</code></a> or
  <a class="autorefs autorefs-internal" href="#frequenz.channels.util.SkipMissedAndResync"><code>SkipMissedAndResync</code></a> policy)</li>
<li><a class="autorefs autorefs-internal" href="#frequenz.channels.util._timer.Timer.timeout"><code>timeout()</code></a> (uses the
  <a class="autorefs autorefs-internal" href="#frequenz.channels.util.SkipMissedAndDrift"><code>SkipMissedAndDrift</code></a> policy)</li>
</ul>
<p>The timer accepts an optional <a class="autorefs autorefs-internal" href="#frequenz.channels.util._timer.Timer.loop"><code>loop</code></a>, which
will be used to track the time. If <code>loop</code> is <code>None</code>, then the running loop will be
used (if there is no running loop most calls will raise
a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError"><code>RuntimeError</code></a>).</p>
<p>Starting the timer can be delayed if necessary by using <code>auto_start=False</code>
(for example until we have a running loop). A call to
<a class="autorefs autorefs-internal" href="#frequenz.channels.util._timer.Timer.reset"><code>reset()</code></a>,
<a class="autorefs autorefs-internal" href="#frequenz.channels.util._timer.Timer.ready"><code>ready()</code></a>,
<a class="autorefs autorefs-internal" href="../#frequenz.channels._base_classes.Receiver.receive"><code>receive()</code></a> or the async iterator interface
to await for a new message will start the timer.</p>

<details class="example" open>
  <summary>Periodic timer example</summary>
  <div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">for</span> <span class="n">drift</span> <span class="ow">in</span> <span class="n">Timer</span><span class="o">.</span><span class="n">periodic</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The timer has triggered </span><span class="si">{</span><span class="n">drift</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>But you can also use a <a class="autorefs autorefs-internal" href="#frequenz.channels.util.select"><code>select</code></a> to combine
it with other receivers, and even start it (semi) manually:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">frequenz.channels.util</span> <span class="kn">import</span> <span class="n">select</span><span class="p">,</span> <span class="n">selected_from</span>
<span class="kn">from</span> <span class="nn">frequenz.channels</span> <span class="kn">import</span> <span class="n">Broadcast</span>

<span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">auto_start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">chan</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">int</span><span class="p">](</span><span class="s2">&quot;input-chan&quot;</span><span class="p">)</span>
<span class="n">battery_data</span> <span class="o">=</span> <span class="n">chan</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">()</span>

<span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">auto_start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># Do some other initialization, the timer will start automatically if</span>
<span class="c1"># a message is awaited (or manually via `reset()`).</span>
<span class="k">async</span> <span class="k">for</span> <span class="n">selected</span> <span class="ow">in</span> <span class="n">select</span><span class="p">(</span><span class="n">battery_data</span><span class="p">,</span> <span class="n">timer</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">battery_data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">selected</span><span class="o">.</span><span class="n">was_closed</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;battery channel closed&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">battery_soc</span> <span class="o">=</span> <span class="n">selected</span><span class="o">.</span><span class="n">value</span>
    <span class="k">elif</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">timer</span><span class="p">):</span>
        <span class="c1"># Print some regular battery data</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Battery is charged at </span><span class="si">{</span><span class="n">battery_soc</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>
</details>
<details class="example" open>
  <summary>Timeout example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">frequenz.channels.util</span> <span class="kn">import</span> <span class="n">select</span><span class="p">,</span> <span class="n">selected_from</span>
<span class="kn">from</span> <span class="nn">frequenz.channels</span> <span class="kn">import</span> <span class="n">Broadcast</span>

<span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Processing data: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">do_heavy_processing</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Heavy processing data: </span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">auto_start</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">chan1</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">int</span><span class="p">](</span><span class="s2">&quot;input-chan-1&quot;</span><span class="p">)</span>
<span class="n">chan2</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">int</span><span class="p">](</span><span class="s2">&quot;input-chan-2&quot;</span><span class="p">)</span>
<span class="n">battery_data</span> <span class="o">=</span> <span class="n">chan1</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">()</span>
<span class="n">heavy_process</span> <span class="o">=</span> <span class="n">chan2</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">()</span>
<span class="k">async</span> <span class="k">for</span> <span class="n">selected</span> <span class="ow">in</span> <span class="n">select</span><span class="p">(</span><span class="n">battery_data</span><span class="p">,</span> <span class="n">heavy_process</span><span class="p">,</span> <span class="n">timer</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">battery_data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">selected</span><span class="o">.</span><span class="n">was_closed</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;battery channel closed&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">process_data</span><span class="p">(</span><span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="n">timer</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">heavy_process</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">selected</span><span class="o">.</span><span class="n">was_closed</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;processing channel closed&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">do_heavy_processing</span><span class="p">(</span><span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">timer</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No data received in time&quot;</span><span class="p">)</span>
</code></pre></div>
<p>In this case <code>do_heavy_processing</code> might take 2 seconds, and we don't
want our timeout timer to trigger for the missed ticks, and want the
next tick to be relative to the time timer was last triggered.</p>
</details>

        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Timer</span><span class="p">(</span><span class="n">Receiver</span><span class="p">[</span><span class="n">timedelta</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A timer receiver that triggers every `interval` time.</span>

<span class="sd">    The timer has microseconds resolution, so the</span>
<span class="sd">    [`interval`][frequenz.channels.util.Timer.interval] must be at least</span>
<span class="sd">    1 microsecond.</span>

<span class="sd">    The message it produces is a [`timedelta`][datetime.timedelta] containing the drift</span>
<span class="sd">    of the timer, i.e. the difference between when the timer should have triggered and</span>
<span class="sd">    the time when it actually triggered.</span>

<span class="sd">    This drift will likely never be `0`, because if there is a task that is</span>
<span class="sd">    running when it should trigger, the timer will be delayed. In this case the</span>
<span class="sd">    drift will be positive. A negative drift should be technically impossible,</span>
<span class="sd">    as the timer uses [`asyncio`][asyncio]s loop monotonic clock.</span>

<span class="sd">    If the timer is delayed too much, then it will behave according to the</span>
<span class="sd">    [`missed_tick_policy`][frequenz.channels.util.Timer.missed_tick_policy]. Missing</span>
<span class="sd">    ticks might or might not trigger a message and the drift could be accumulated or not</span>
<span class="sd">    depending on the chosen policy.</span>

<span class="sd">    These are the currently built-in available policies:</span>

<span class="sd">    * [`SkipMissedAndDrift`][frequenz.channels.util.SkipMissedAndDrift]</span>
<span class="sd">    * [`SkipMissedAndResync`][frequenz.channels.util.SkipMissedAndResync]</span>
<span class="sd">    * [`TriggerAllMissed`][frequenz.channels.util.TriggerAllMissed]</span>

<span class="sd">    For the most common cases, a specialized constructor is provided:</span>

<span class="sd">    * [`periodic()`][frequenz.channels.util.Timer.periodic] (uses the</span>
<span class="sd">      [`TriggerAllMissed`][frequenz.channels.util.TriggerAllMissed] or</span>
<span class="sd">      [`SkipMissedAndResync`][frequenz.channels.util.SkipMissedAndResync] policy)</span>
<span class="sd">    * [`timeout()`][frequenz.channels.util.Timer.timeout] (uses the</span>
<span class="sd">      [`SkipMissedAndDrift`][frequenz.channels.util.SkipMissedAndDrift] policy)</span>

<span class="sd">    The timer accepts an optional [`loop`][frequenz.channels.util.Timer.loop], which</span>
<span class="sd">    will be used to track the time. If `loop` is `None`, then the running loop will be</span>
<span class="sd">    used (if there is no running loop most calls will raise</span>
<span class="sd">    a [`RuntimeError`][RuntimeError]).</span>

<span class="sd">    Starting the timer can be delayed if necessary by using `auto_start=False`</span>
<span class="sd">    (for example until we have a running loop). A call to</span>
<span class="sd">    [`reset()`][frequenz.channels.util.Timer.reset],</span>
<span class="sd">    [`ready()`][frequenz.channels.util.Timer.ready],</span>
<span class="sd">    [`receive()`][frequenz.channels.util.Timer.receive] or the async iterator interface</span>
<span class="sd">    to await for a new message will start the timer.</span>

<span class="sd">    Example: Periodic timer example</span>
<span class="sd">        ```python</span>
<span class="sd">        async for drift in Timer.periodic(timedelta(seconds=1.0)):</span>
<span class="sd">            print(f&quot;The timer has triggered {drift=}&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        But you can also use a [`select`][frequenz.channels.util.select] to combine</span>
<span class="sd">        it with other receivers, and even start it (semi) manually:</span>

<span class="sd">        ```python</span>
<span class="sd">        import logging</span>
<span class="sd">        from frequenz.channels.util import select, selected_from</span>
<span class="sd">        from frequenz.channels import Broadcast</span>

<span class="sd">        timer = Timer.timeout(timedelta(seconds=1.0), auto_start=False)</span>
<span class="sd">        chan = Broadcast[int](&quot;input-chan&quot;)</span>
<span class="sd">        battery_data = chan.new_receiver()</span>

<span class="sd">        timer = Timer.timeout(timedelta(seconds=1.0), auto_start=False)</span>
<span class="sd">        # Do some other initialization, the timer will start automatically if</span>
<span class="sd">        # a message is awaited (or manually via `reset()`).</span>
<span class="sd">        async for selected in select(battery_data, timer):</span>
<span class="sd">            if selected_from(selected, battery_data):</span>
<span class="sd">                if selected.was_closed():</span>
<span class="sd">                    logging.warning(&quot;battery channel closed&quot;)</span>
<span class="sd">                    continue</span>
<span class="sd">                battery_soc = selected.value</span>
<span class="sd">            elif selected_from(selected, timer):</span>
<span class="sd">                # Print some regular battery data</span>
<span class="sd">                print(f&quot;Battery is charged at {battery_soc}%&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">    Example: Timeout example</span>
<span class="sd">        ```python</span>
<span class="sd">        import logging</span>
<span class="sd">        from frequenz.channels.util import select, selected_from</span>
<span class="sd">        from frequenz.channels import Broadcast</span>

<span class="sd">        def process_data(data: int):</span>
<span class="sd">            logging.info(&quot;Processing data: %d&quot;, data)</span>

<span class="sd">        def do_heavy_processing(data: int):</span>
<span class="sd">            logging.info(&quot;Heavy processing data: %d&quot;, data)</span>

<span class="sd">        timer = Timer.timeout(timedelta(seconds=1.0), auto_start=False)</span>
<span class="sd">        chan1 = Broadcast[int](&quot;input-chan-1&quot;)</span>
<span class="sd">        chan2 = Broadcast[int](&quot;input-chan-2&quot;)</span>
<span class="sd">        battery_data = chan1.new_receiver()</span>
<span class="sd">        heavy_process = chan2.new_receiver()</span>
<span class="sd">        async for selected in select(battery_data, heavy_process, timer):</span>
<span class="sd">            if selected_from(selected, battery_data):</span>
<span class="sd">                if selected.was_closed():</span>
<span class="sd">                    logging.warning(&quot;battery channel closed&quot;)</span>
<span class="sd">                    continue</span>
<span class="sd">                process_data(selected.value)</span>
<span class="sd">                timer.reset()</span>
<span class="sd">            elif selected_from(selected, heavy_process):</span>
<span class="sd">                if selected.was_closed():</span>
<span class="sd">                    logging.warning(&quot;processing channel closed&quot;)</span>
<span class="sd">                    continue</span>
<span class="sd">                do_heavy_processing(selected.value)</span>
<span class="sd">            elif selected_from(selected, timer):</span>
<span class="sd">                logging.warning(&quot;No data received in time&quot;)</span>
<span class="sd">        ```</span>

<span class="sd">        In this case `do_heavy_processing` might take 2 seconds, and we don&#39;t</span>
<span class="sd">        want our timeout timer to trigger for the missed ticks, and want the</span>
<span class="sd">        next tick to be relative to the time timer was last triggered.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">interval</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="n">missed_tick_policy</span><span class="p">:</span> <span class="n">MissedTickPolicy</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">auto_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an instance.</span>

<span class="sd">        See the class documentation for details.</span>

<span class="sd">        Args:</span>
<span class="sd">            interval: The time between timer ticks. Must be at least</span>
<span class="sd">                1 microsecond.</span>
<span class="sd">            missed_tick_policy: The policy of the timer when it misses a tick.</span>
<span class="sd">                Commonly one of `TriggerAllMissed`, `SkipMissedAndResync`, `SkipMissedAndDrift`</span>
<span class="sd">                or a custom class deriving from `MissedTickPolicy`. See the</span>
<span class="sd">                documentation of the each class for more details.</span>
<span class="sd">            auto_start: Whether the timer should be started when the</span>
<span class="sd">                instance is created. This can only be `True` if there is</span>
<span class="sd">                already a running loop or an explicit `loop` that is running</span>
<span class="sd">                was passed.</span>
<span class="sd">            loop: The event loop to use to track time. If `None`,</span>
<span class="sd">                `asyncio.get_running_loop()` will be used.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if it was called without a loop and there is no</span>
<span class="sd">                running loop.</span>
<span class="sd">            ValueError: if `interval` is not positive or is smaller than 1</span>
<span class="sd">                microsecond.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">_to_microseconds</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The time to between timer ticks.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_missed_tick_policy</span><span class="p">:</span> <span class="n">MissedTickPolicy</span> <span class="o">=</span> <span class="n">missed_tick_policy</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The policy of the timer when it misses a tick.</span>

<span class="sd">        See the documentation of `MissedTickPolicy` for details.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">loop</span> <span class="k">if</span> <span class="n">loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
        <span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The event loop to use to track time.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the timer was requested to stop.</span>

<span class="sd">        If this is `False`, then the timer is running.</span>

<span class="sd">        If this is `True`, then it is stopped or there is a request to stop it</span>
<span class="sd">        or it was not started yet:</span>

<span class="sd">        * If `_next_msg_time` is `None`, it means it wasn&#39;t started yet (it was</span>
<span class="sd">          created with `auto_start=False`).  Any receiving method will start</span>
<span class="sd">          it by calling `reset()` in this case.</span>

<span class="sd">        * If `_next_msg_time` is not `None`, it means there was a request to</span>
<span class="sd">          stop it.  In this case receiving methods will raise</span>
<span class="sd">          a `ReceiverClosedError`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The absolute (monotonic) time when the timer should trigger.</span>

<span class="sd">        If this is `None`, it means the timer didn&#39;t start yet, but it should</span>
<span class="sd">        be started as soon as it is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The difference between `_next_msg_time` and the triggered time.</span>

<span class="sd">        This is calculated by `ready()` but is returned by `consume()`. If</span>
<span class="sd">        `None` it means `ready()` wasn&#39;t called and `consume()` will assert.</span>
<span class="sd">        `consume()` will set it back to `None` to tell `ready()` that it needs</span>
<span class="sd">        to wait again.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The `interval` must be positive and at least 1 microsecond, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;not </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="si">}</span><span class="s2"> microseconds)&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">auto_start</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">timeout</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">delay</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">auto_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a timer useful for tracking timeouts.</span>

<span class="sd">        This is basically a shortcut to create a timer with</span>
<span class="sd">        `SkipMissedAndDrift(delay_tolerance=timedelta(0))` as the missed tick policy.</span>

<span class="sd">        See the class documentation for details.</span>

<span class="sd">        Args:</span>
<span class="sd">            delay: The time until the timer ticks. Must be at least</span>
<span class="sd">                1 microsecond.</span>
<span class="sd">            auto_start: Whether the timer should be started when the</span>
<span class="sd">                instance is created. This can only be `True` if there is</span>
<span class="sd">                already a running loop or an explicit `loop` that is running</span>
<span class="sd">                was passed.</span>
<span class="sd">            loop: The event loop to use to track time. If `None`,</span>
<span class="sd">                `asyncio.get_running_loop()` will be used.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The timer instance.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if it was called without a loop and there is no</span>
<span class="sd">                running loop.</span>
<span class="sd">            ValueError: if `interval` is not positive or is smaller than 1</span>
<span class="sd">                microsecond.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Timer</span><span class="p">(</span>
            <span class="n">delay</span><span class="p">,</span>
            <span class="n">SkipMissedAndDrift</span><span class="p">(</span><span class="n">delay_tolerance</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
            <span class="n">auto_start</span><span class="o">=</span><span class="n">auto_start</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">periodic</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">period</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">skip_missed_ticks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">auto_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a periodic timer.</span>

<span class="sd">        This is basically a shortcut to create a timer with either</span>
<span class="sd">        `TriggerAllMissed()` or `SkipMissedAndResync()` as the missed tick policy</span>
<span class="sd">        (depending on `skip_missed_ticks`).</span>

<span class="sd">        See the class documentation for details.</span>

<span class="sd">        Args:</span>
<span class="sd">            period: The time between timer ticks. Must be at least</span>
<span class="sd">                1 microsecond.</span>
<span class="sd">            skip_missed_ticks: Whether to skip missed ticks or trigger them</span>
<span class="sd">                all until it catches up.</span>
<span class="sd">            auto_start: Whether the timer should be started when the</span>
<span class="sd">                instance is created. This can only be `True` if there is</span>
<span class="sd">                already a running loop or an explicit `loop` that is running</span>
<span class="sd">                was passed.</span>
<span class="sd">            loop: The event loop to use to track time. If `None`,</span>
<span class="sd">                `asyncio.get_running_loop()` will be used.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The timer instance.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if it was called without a loop and there is no</span>
<span class="sd">                running loop.</span>
<span class="sd">            ValueError: if `interval` is not positive or is smaller than 1</span>
<span class="sd">                microsecond.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">missed_tick_policy</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">SkipMissedAndResync</span><span class="p">()</span> <span class="k">if</span> <span class="n">skip_missed_ticks</span> <span class="k">else</span> <span class="n">TriggerAllMissed</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">Timer</span><span class="p">(</span>
            <span class="n">period</span><span class="p">,</span>
            <span class="n">missed_tick_policy</span><span class="p">,</span>
            <span class="n">auto_start</span><span class="o">=</span><span class="n">auto_start</span><span class="p">,</span>
            <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">interval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">timedelta</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The interval between timer ticks.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The interval between timer ticks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">microseconds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">missed_tick_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MissedTickPolicy</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The policy of the timer when it misses a tick.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The policy of the timer when it misses a tick.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_missed_tick_policy</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The event loop used by the timer to track time.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The event loop used by the timer to track time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_running</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the timer is running.</span>

<span class="sd">        This will be `False` if the timer was stopped, or not started yet.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the timer is running.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the timer to start timing from now.</span>

<span class="sd">        If the timer was stopped, or not started yet, it will be started.</span>

<span class="sd">        This can only be called with a running loop, see the class</span>
<span class="sd">        documentation for more details.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if it was called without a running loop.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the timer.</span>

<span class="sd">        Once `stop` has been called, all subsequent calls to `ready()` will</span>
<span class="sd">        immediately return False and calls to `consume()` / `receive()` or any</span>
<span class="sd">        use of the async iterator interface will raise</span>
<span class="sd">        a `ReceiverStoppedError`.</span>

<span class="sd">        You can restart the timer with `reset()`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># We need to make sure it&#39;s not None, otherwise `ready()` will start it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wait until the timer `interval` passed.</span>

<span class="sd">        Once a call to `ready()` has finished, the resulting tick information</span>
<span class="sd">        must be read with a call to `consume()` (`receive()` or iterated over)</span>
<span class="sd">        to tell the timer it should wait for the next interval.</span>

<span class="sd">        The timer will remain ready (this method will return immediately)</span>
<span class="sd">        until it is consumed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether the timer was started and it is still running.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if it was called without a running loop.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If there are messages waiting to be consumed, return immediately.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># If `_next_tick_time` is `None`, it means it was created with</span>
        <span class="c1"># `auto_start=False` and should be started.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">),</span> <span class="s2">&quot;This should be assigned by reset()&quot;</span>

        <span class="c1"># If a stop was explicitly requested, we bail out.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">now</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">()</span>
        <span class="n">time_to_next_tick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="o">-</span> <span class="n">now</span>
        <span class="c1"># If we didn&#39;t reach the tick yet, sleep until we do.</span>
        <span class="k">if</span> <span class="n">time_to_next_tick</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">time_to_next_tick</span> <span class="o">/</span> <span class="mi">1_000_000</span><span class="p">)</span>
            <span class="n">now</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">()</span>

        <span class="c1"># If a stop was explicitly requested during the sleep, we bail out.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">microseconds</span><span class="o">=</span><span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_missed_tick_policy</span><span class="o">.</span><span class="n">calculate_next_tick_time</span><span class="p">(</span>
            <span class="n">now</span><span class="o">=</span><span class="n">now</span><span class="p">,</span>
            <span class="n">scheduled_tick_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span><span class="p">,</span>
            <span class="n">interval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">timedelta</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the latest drift once `ready()` is complete.</span>

<span class="sd">        Once the timer has triggered (`ready()` is done), this method returns the</span>
<span class="sd">        difference between when the timer should have triggered and the time when</span>
<span class="sd">        it actually triggered. See the class documentation for more details.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The difference between when the timer should have triggered and the</span>
<span class="sd">                time when it actually did.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ReceiverStoppedError: if the timer was stopped via `stop()`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If it was stopped and there it no pending result, we raise</span>
        <span class="c1"># (if there is a pending result, then we still want to return it first)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">assert</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">),</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>
        <span class="n">drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">drift</span>

    <span class="k">def</span> <span class="nf">_now</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the current monotonic clock time in microseconds.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The current monotonic clock time in microseconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_to_microseconds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_loop</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of the timer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The string representation of the timer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of the timer.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The string representation of the timer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">missed_tick_policy</span><span class="si">=}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">loop</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="si">=}</span><span class="s2">&gt;&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">





<h5 id="frequenz.channels.util.Timer-attributes">Attributes<a href="#frequenz.channels.util.Timer-attributes" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._timer.Timer.interval" class="doc doc-heading">
<code class="highlight language-python"><span class="n">interval</span><span class="p">:</span> <span class="n">timedelta</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._timer.Timer.interval" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>The interval between timer ticks.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="datetime.timedelta" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The interval between timer ticks.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._timer.Timer.is_running" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_running</span><span class="p">:</span> <span class="nb">bool</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._timer.Timer.is_running" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Whether the timer is running.</p>
<p>This will be <code>False</code> if the timer was stopped, or not started yet.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether the timer is running.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._timer.Timer.loop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._timer.Timer.loop" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>The event loop used by the timer to track time.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio.html#module-asyncio">asyncio</a>.<a class="autorefs autorefs-external" title="asyncio.AbstractEventLoop" href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.AbstractEventLoop">AbstractEventLoop</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The event loop used by the timer to track time.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="frequenz.channels.util._timer.Timer.missed_tick_policy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">missed_tick_policy</span><span class="p">:</span> <span class="n">MissedTickPolicy</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#frequenz.channels.util._timer.Timer.missed_tick_policy" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>The policy of the timer when it misses a tick.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._timer.MissedTickPolicy" href="#frequenz.channels.util.MissedTickPolicy">MissedTickPolicy</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The policy of the timer when it misses a tick.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<h5 id="frequenz.channels.util.Timer-functions">Functions<a href="#frequenz.channels.util.Timer-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.Timer.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">missed_tick_policy</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">auto_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#frequenz.channels.util._timer.Timer.__init__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create an instance.</p>
<p>See the class documentation for details.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>interval</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The time between timer ticks. Must be at least
1 microsecond.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="datetime.timedelta" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>missed_tick_policy</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The policy of the timer when it misses a tick.
Commonly one of <code>TriggerAllMissed</code>, <code>SkipMissedAndResync</code>, <code>SkipMissedAndDrift</code>
or a custom class deriving from <code>MissedTickPolicy</code>. See the
documentation of the each class for more details.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._timer.MissedTickPolicy" href="#frequenz.channels.util.MissedTickPolicy">MissedTickPolicy</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>auto_start</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Whether the timer should be started when the
instance is created. This can only be <code>True</code> if there is
already a running loop or an explicit <code>loop</code> that is running
was passed.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>loop</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The event loop to use to track time. If <code>None</code>,
<code>asyncio.get_running_loop()</code> will be used.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio.html#module-asyncio">asyncio</a>.<a class="autorefs autorefs-external" title="asyncio.AbstractEventLoop" href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.AbstractEventLoop">AbstractEventLoop</a> | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if it was called without a loop and there is no
running loop.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if <code>interval</code> is not positive or is smaller than 1
microsecond.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="n">missed_tick_policy</span><span class="p">:</span> <span class="n">MissedTickPolicy</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">auto_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an instance.</span>

<span class="sd">    See the class documentation for details.</span>

<span class="sd">    Args:</span>
<span class="sd">        interval: The time between timer ticks. Must be at least</span>
<span class="sd">            1 microsecond.</span>
<span class="sd">        missed_tick_policy: The policy of the timer when it misses a tick.</span>
<span class="sd">            Commonly one of `TriggerAllMissed`, `SkipMissedAndResync`, `SkipMissedAndDrift`</span>
<span class="sd">            or a custom class deriving from `MissedTickPolicy`. See the</span>
<span class="sd">            documentation of the each class for more details.</span>
<span class="sd">        auto_start: Whether the timer should be started when the</span>
<span class="sd">            instance is created. This can only be `True` if there is</span>
<span class="sd">            already a running loop or an explicit `loop` that is running</span>
<span class="sd">            was passed.</span>
<span class="sd">        loop: The event loop to use to track time. If `None`,</span>
<span class="sd">            `asyncio.get_running_loop()` will be used.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if it was called without a loop and there is no</span>
<span class="sd">            running loop.</span>
<span class="sd">        ValueError: if `interval` is not positive or is smaller than 1</span>
<span class="sd">            microsecond.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">_to_microseconds</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The time to between timer ticks.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_missed_tick_policy</span><span class="p">:</span> <span class="n">MissedTickPolicy</span> <span class="o">=</span> <span class="n">missed_tick_policy</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The policy of the timer when it misses a tick.</span>

<span class="sd">    See the documentation of `MissedTickPolicy` for details.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">loop</span> <span class="k">if</span> <span class="n">loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_running_loop</span><span class="p">()</span>
    <span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The event loop to use to track time.&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Whether the timer was requested to stop.</span>

<span class="sd">    If this is `False`, then the timer is running.</span>

<span class="sd">    If this is `True`, then it is stopped or there is a request to stop it</span>
<span class="sd">    or it was not started yet:</span>

<span class="sd">    * If `_next_msg_time` is `None`, it means it wasn&#39;t started yet (it was</span>
<span class="sd">      created with `auto_start=False`).  Any receiving method will start</span>
<span class="sd">      it by calling `reset()` in this case.</span>

<span class="sd">    * If `_next_msg_time` is not `None`, it means there was a request to</span>
<span class="sd">      stop it.  In this case receiving methods will raise</span>
<span class="sd">      a `ReceiverClosedError`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The absolute (monotonic) time when the timer should trigger.</span>

<span class="sd">    If this is `None`, it means the timer didn&#39;t start yet, but it should</span>
<span class="sd">    be started as soon as it is used.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The difference between `_next_msg_time` and the triggered time.</span>

<span class="sd">    This is calculated by `ready()` but is returned by `consume()`. If</span>
<span class="sd">    `None` it means `ready()` wasn&#39;t called and `consume()` will assert.</span>
<span class="sd">    `consume()` will set it back to `None` to tell `ready()` that it needs</span>
<span class="sd">    to wait again.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The `interval` must be positive and at least 1 microsecond, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;not </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="si">}</span><span class="s2"> microseconds)&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">auto_start</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.Timer.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._timer.Timer.__repr__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a string representation of the timer.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The string representation of the timer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of the timer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The string representation of the timer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">missed_tick_policy</span><span class="si">=}</span><span class="s2">, &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">loop</span><span class="si">=}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">is_running</span><span class="si">=}</span><span class="s2">&gt;&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.Timer.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._timer.Timer.__str__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return a string representation of the timer.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The string representation of the timer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a string representation of the timer.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The string representation of the timer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.Timer.consume" class="doc doc-heading">
<code class="highlight language-python"><span class="n">consume</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._timer.Timer.consume" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Return the latest drift once <code>ready()</code> is complete.</p>
<p>Once the timer has triggered (<code>ready()</code> is done), this method returns the
difference between when the timer should have triggered and the time when
it actually triggered. See the class documentation for more details.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="datetime.timedelta" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The difference between when the timer should have triggered and the
time when it actually did.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels._exceptions.ReceiverStoppedError" href="../#frequenz.channels.ReceiverStoppedError">ReceiverStoppedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if the timer was stopped via <code>stop()</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">consume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">timedelta</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the latest drift once `ready()` is complete.</span>

<span class="sd">    Once the timer has triggered (`ready()` is done), this method returns the</span>
<span class="sd">    difference between when the timer should have triggered and the time when</span>
<span class="sd">    it actually triggered. See the class documentation for more details.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The difference between when the timer should have triggered and the</span>
<span class="sd">            time when it actually did.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ReceiverStoppedError: if the timer was stopped via `stop()`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If it was stopped and there it no pending result, we raise</span>
    <span class="c1"># (if there is a pending result, then we still want to return it first)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ReceiverStoppedError</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">assert</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="p">),</span> <span class="s2">&quot;calls to `consume()` must be follow a call to `ready()`&quot;</span>
    <span class="n">drift</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">drift</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.Timer.periodic" class="doc doc-heading">
<code class="highlight language-python"><span class="n">periodic</span><span class="p">(</span><span class="n">period</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">skip_missed_ticks</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">auto_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#frequenz.channels.util._timer.Timer.periodic" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a periodic timer.</p>
<p>This is basically a shortcut to create a timer with either
<code>TriggerAllMissed()</code> or <code>SkipMissedAndResync()</code> as the missed tick policy
(depending on <code>skip_missed_ticks</code>).</p>
<p>See the class documentation for details.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>period</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The time between timer ticks. Must be at least
1 microsecond.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="datetime.timedelta" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>skip_missed_ticks</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Whether to skip missed ticks or trigger them
all until it catches up.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>False</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>auto_start</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Whether the timer should be started when the
instance is created. This can only be <code>True</code> if there is
already a running loop or an explicit <code>loop</code> that is running
was passed.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>loop</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The event loop to use to track time. If <code>None</code>,
<code>asyncio.get_running_loop()</code> will be used.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio.html#module-asyncio">asyncio</a>.<a class="autorefs autorefs-external" title="asyncio.AbstractEventLoop" href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.AbstractEventLoop">AbstractEventLoop</a> | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._timer.Timer" href="#frequenz.channels.util.Timer">Timer</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The timer instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if it was called without a loop and there is no
running loop.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if <code>interval</code> is not positive or is smaller than 1
microsecond.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">periodic</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">period</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">skip_missed_ticks</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">auto_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a periodic timer.</span>

<span class="sd">    This is basically a shortcut to create a timer with either</span>
<span class="sd">    `TriggerAllMissed()` or `SkipMissedAndResync()` as the missed tick policy</span>
<span class="sd">    (depending on `skip_missed_ticks`).</span>

<span class="sd">    See the class documentation for details.</span>

<span class="sd">    Args:</span>
<span class="sd">        period: The time between timer ticks. Must be at least</span>
<span class="sd">            1 microsecond.</span>
<span class="sd">        skip_missed_ticks: Whether to skip missed ticks or trigger them</span>
<span class="sd">            all until it catches up.</span>
<span class="sd">        auto_start: Whether the timer should be started when the</span>
<span class="sd">            instance is created. This can only be `True` if there is</span>
<span class="sd">            already a running loop or an explicit `loop` that is running</span>
<span class="sd">            was passed.</span>
<span class="sd">        loop: The event loop to use to track time. If `None`,</span>
<span class="sd">            `asyncio.get_running_loop()` will be used.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The timer instance.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if it was called without a loop and there is no</span>
<span class="sd">            running loop.</span>
<span class="sd">        ValueError: if `interval` is not positive or is smaller than 1</span>
<span class="sd">            microsecond.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">missed_tick_policy</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">SkipMissedAndResync</span><span class="p">()</span> <span class="k">if</span> <span class="n">skip_missed_ticks</span> <span class="k">else</span> <span class="n">TriggerAllMissed</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Timer</span><span class="p">(</span>
        <span class="n">period</span><span class="p">,</span>
        <span class="n">missed_tick_policy</span><span class="p">,</span>
        <span class="n">auto_start</span><span class="o">=</span><span class="n">auto_start</span><span class="p">,</span>
        <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.Timer.ready" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ready</span><span class="p">()</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.util._timer.Timer.ready" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Wait until the timer <code>interval</code> passed.</p>
<p>Once a call to <code>ready()</code> has finished, the resulting tick information
must be read with a call to <code>consume()</code> (<code>receive()</code> or iterated over)
to tell the timer it should wait for the next interval.</p>
<p>The timer will remain ready (this method will return immediately)
until it is consumed.</p>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether the timer was started and it is still running.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if it was called without a running loop.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wait until the timer `interval` passed.</span>

<span class="sd">    Once a call to `ready()` has finished, the resulting tick information</span>
<span class="sd">    must be read with a call to `consume()` (`receive()` or iterated over)</span>
<span class="sd">    to tell the timer it should wait for the next interval.</span>

<span class="sd">    The timer will remain ready (this method will return immediately)</span>
<span class="sd">    until it is consumed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the timer was started and it is still running.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if it was called without a running loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If there are messages waiting to be consumed, return immediately.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># If `_next_tick_time` is `None`, it means it was created with</span>
    <span class="c1"># `auto_start=False` and should be started.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">),</span> <span class="s2">&quot;This should be assigned by reset()&quot;</span>

    <span class="c1"># If a stop was explicitly requested, we bail out.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="n">now</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">()</span>
    <span class="n">time_to_next_tick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="o">-</span> <span class="n">now</span>
    <span class="c1"># If we didn&#39;t reach the tick yet, sleep until we do.</span>
    <span class="k">if</span> <span class="n">time_to_next_tick</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">time_to_next_tick</span> <span class="o">/</span> <span class="mi">1_000_000</span><span class="p">)</span>
        <span class="n">now</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">()</span>

    <span class="c1"># If a stop was explicitly requested during the sleep, we bail out.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">microseconds</span><span class="o">=</span><span class="n">now</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_missed_tick_policy</span><span class="o">.</span><span class="n">calculate_next_tick_time</span><span class="p">(</span>
        <span class="n">now</span><span class="o">=</span><span class="n">now</span><span class="p">,</span>
        <span class="n">scheduled_tick_time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span><span class="p">,</span>
        <span class="n">interval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.Timer.reset" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._timer.Timer.reset" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Reset the timer to start timing from now.</p>
<p>If the timer was stopped, or not started yet, it will be started.</p>
<p>This can only be called with a running loop, see the class
documentation for more details.</p>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if it was called without a running loop.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset the timer to start timing from now.</span>

<span class="sd">    If the timer was stopped, or not started yet, it will be started.</span>

<span class="sd">    This can only be called with a running loop, see the class</span>
<span class="sd">    documentation for more details.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if it was called without a running loop.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_current_drift</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.Timer.stop" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stop</span><span class="p">()</span></code>

<a href="#frequenz.channels.util._timer.Timer.stop" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Stop the timer.</p>
<p>Once <code>stop</code> has been called, all subsequent calls to <code>ready()</code> will
immediately return False and calls to <code>consume()</code> / <code>receive()</code> or any
use of the async iterator interface will raise
a <code>ReceiverStoppedError</code>.</p>
<p>You can restart the timer with <code>reset()</code>.</p>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop the timer.</span>

<span class="sd">    Once `stop` has been called, all subsequent calls to `ready()` will</span>
<span class="sd">    immediately return False and calls to `consume()` / `receive()` or any</span>
<span class="sd">    use of the async iterator interface will raise</span>
<span class="sd">    a `ReceiverStoppedError`.</span>

<span class="sd">    You can restart the timer with `reset()`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stopped</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># We need to make sure it&#39;s not None, otherwise `ready()` will start it</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_next_tick_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_now</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.Timer.timeout" class="doc doc-heading">
<code class="highlight language-python"><span class="n">timeout</span><span class="p">(</span><span class="n">delay</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">auto_start</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loop</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#frequenz.channels.util._timer.Timer.timeout" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a timer useful for tracking timeouts.</p>
<p>This is basically a shortcut to create a timer with
<code>SkipMissedAndDrift(delay_tolerance=timedelta(0))</code> as the missed tick policy.</p>
<p>See the class documentation for details.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>delay</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The time until the timer ticks. Must be at least
1 microsecond.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" title="datetime.timedelta" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta">timedelta</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>auto_start</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>Whether the timer should be started when the
instance is created. This can only be <code>True</code> if there is
already a running loop or an explicit <code>loop</code> that is running
was passed.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>True</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>loop</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The event loop to use to track time. If <code>None</code>,
<code>asyncio.get_running_loop()</code> will be used.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio.html#module-asyncio">asyncio</a>.<a class="autorefs autorefs-external" title="asyncio.AbstractEventLoop" href="https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.AbstractEventLoop">AbstractEventLoop</a> | None</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>None</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._timer.Timer" href="#frequenz.channels.util.Timer">Timer</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The timer instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError">RuntimeError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if it was called without a loop and there is no
running loop.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/exceptions.html#ValueError">ValueError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>if <code>interval</code> is not positive or is smaller than 1
microsecond.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">timeout</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">delay</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">auto_start</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">loop</span><span class="p">:</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a timer useful for tracking timeouts.</span>

<span class="sd">    This is basically a shortcut to create a timer with</span>
<span class="sd">    `SkipMissedAndDrift(delay_tolerance=timedelta(0))` as the missed tick policy.</span>

<span class="sd">    See the class documentation for details.</span>

<span class="sd">    Args:</span>
<span class="sd">        delay: The time until the timer ticks. Must be at least</span>
<span class="sd">            1 microsecond.</span>
<span class="sd">        auto_start: Whether the timer should be started when the</span>
<span class="sd">            instance is created. This can only be `True` if there is</span>
<span class="sd">            already a running loop or an explicit `loop` that is running</span>
<span class="sd">            was passed.</span>
<span class="sd">        loop: The event loop to use to track time. If `None`,</span>
<span class="sd">            `asyncio.get_running_loop()` will be used.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The timer instance.</span>

<span class="sd">    Raises:</span>
<span class="sd">        RuntimeError: if it was called without a loop and there is no</span>
<span class="sd">            running loop.</span>
<span class="sd">        ValueError: if `interval` is not positive or is smaller than 1</span>
<span class="sd">            microsecond.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Timer</span><span class="p">(</span>
        <span class="n">delay</span><span class="p">,</span>
        <span class="n">SkipMissedAndDrift</span><span class="p">(</span><span class="n">delay_tolerance</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)),</span>
        <span class="n">auto_start</span><span class="o">=</span><span class="n">auto_start</span><span class="p">,</span>
        <span class="n">loop</span><span class="o">=</span><span class="n">loop</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.TriggerAllMissed" class="doc doc-heading">
        <code>frequenz.channels.util.TriggerAllMissed</code>


<a href="#frequenz.channels.util.TriggerAllMissed" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._timer.MissedTickPolicy" href="#frequenz.channels.util.MissedTickPolicy">MissedTickPolicy</a></code></p>

  
      <p>A policy that triggers all the missed ticks immediately until it catches up.</p>

<details class="example" open>
  <summary>Example</summary>
  <p>Assume a timer with interval 1 second, the tick <code>T0</code> happens exactly
at time 0, the second tick, <code>T1</code>, happens at time 1.2 (0.2 seconds
late), so it trigges immediately.  The third tick, <code>T2</code>, happens at
time 2.3 (0.3 seconds late), so it also triggers immediately.  The
fourth tick, <code>T3</code>, happens at time 4.3 (1.3 seconds late), so it also
triggers immediately as well as the fifth tick, <code>T4</code>, which was also
already delayed (by 0.3 seconds), so it catches up.  The sixth tick,
<code>T5</code>, happens at 5.1 (0.1 seconds late), so it triggers immediately
again. The seventh tick, <code>T6</code>, happens at 6.0, right on time.</p>
<div class="highlight"><pre><span></span><code>0         1         2         3         4  o      5         6
o---------|-o-------|--o------|---------|--o------|o--------o-----&gt; time
T0          T1         T2                  T3      T5       T6
                                           T4
</code></pre></div>
</details>

        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TriggerAllMissed</span><span class="p">(</span><span class="n">MissedTickPolicy</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A policy that triggers all the missed ticks immediately until it catches up.</span>

<span class="sd">    Example:</span>
<span class="sd">        Assume a timer with interval 1 second, the tick `T0` happens exactly</span>
<span class="sd">        at time 0, the second tick, `T1`, happens at time 1.2 (0.2 seconds</span>
<span class="sd">        late), so it trigges immediately.  The third tick, `T2`, happens at</span>
<span class="sd">        time 2.3 (0.3 seconds late), so it also triggers immediately.  The</span>
<span class="sd">        fourth tick, `T3`, happens at time 4.3 (1.3 seconds late), so it also</span>
<span class="sd">        triggers immediately as well as the fifth tick, `T4`, which was also</span>
<span class="sd">        already delayed (by 0.3 seconds), so it catches up.  The sixth tick,</span>
<span class="sd">        `T5`, happens at 5.1 (0.1 seconds late), so it triggers immediately</span>
<span class="sd">        again. The seventh tick, `T6`, happens at 6.0, right on time.</span>

<span class="sd">        ```</span>
<span class="sd">        0         1         2         3         4  o      5         6</span>
<span class="sd">        o---------|-o-------|--o------|---------|--o------|o--------o-----&gt; time</span>
<span class="sd">        T0          T1         T2                  T3      T5       T6</span>
<span class="sd">                                                   T4</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">calculate_next_tick_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">now</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the next tick time.</span>

<span class="sd">        This method always returns `scheduled_tick_time + interval`, as all</span>
<span class="sd">        ticks need to produce a trigger event.</span>

<span class="sd">        Args:</span>
<span class="sd">            now: The current loop time (in microseconds).</span>
<span class="sd">            scheduled_tick_time: The time the current tick was scheduled to</span>
<span class="sd">                trigger (in microseconds).</span>
<span class="sd">            interval: The interval between ticks (in microseconds).</span>

<span class="sd">        Returns:</span>
<span class="sd">            The next tick time (in microseconds).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">scheduled_tick_time</span> <span class="o">+</span> <span class="n">interval</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.util.TriggerAllMissed-functions">Functions<a href="#frequenz.channels.util.TriggerAllMissed-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._timer.TriggerAllMissed.calculate_next_tick_time" class="doc doc-heading">
<code class="highlight language-python"><span class="n">calculate_next_tick_time</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">now</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span></code>

<a href="#frequenz.channels.util._timer.TriggerAllMissed.calculate_next_tick_time" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Calculate the next tick time.</p>
<p>This method always returns <code>scheduled_tick_time + interval</code>, as all
ticks need to produce a trigger event.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>now</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The current loop time (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>scheduled_tick_time</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The time the current tick was scheduled to
trigger (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The interval between ticks (in microseconds).</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>The next tick time (in microseconds).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_timer.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_next_tick_time</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">now</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">scheduled_tick_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the next tick time.</span>

<span class="sd">    This method always returns `scheduled_tick_time + interval`, as all</span>
<span class="sd">    ticks need to produce a trigger event.</span>

<span class="sd">    Args:</span>
<span class="sd">        now: The current loop time (in microseconds).</span>
<span class="sd">        scheduled_tick_time: The time the current tick was scheduled to</span>
<span class="sd">            trigger (in microseconds).</span>
<span class="sd">        interval: The interval between ticks (in microseconds).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The next tick time (in microseconds).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">scheduled_tick_time</span> <span class="o">+</span> <span class="n">interval</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="frequenz.channels.util.UnhandledSelectedError" class="doc doc-heading">
        <code>frequenz.channels.util.UnhandledSelectedError</code>


<a href="#frequenz.channels.util.UnhandledSelectedError" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._select.SelectError" href="#frequenz.channels.util.SelectError">SelectError</a></code>, <code><a class="autorefs autorefs-external" title="typing.Generic" href="https://docs.python.org/3/library/typing.html#typing.Generic">Generic</a>[<span title="frequenz.channels.util._select._T">_T</span>]</code></p>

  
      <p>A receiver was not handled in a <a class="autorefs autorefs-internal" href="#frequenz.channels.util.select"><code>select()</code></a> loop.</p>
<p>This exception is raised when a <code>select()</code> iteration finishes without a call to
<a class="autorefs autorefs-internal" href="#frequenz.channels.util.selected_from"><code>selected_from()</code></a> for the selected receiver.</p>


        <details class="quote">
          <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">UnhandledSelectedError</span><span class="p">(</span><span class="n">SelectError</span><span class="p">,</span> <span class="n">Generic</span><span class="p">[</span><span class="n">_T</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A receiver was not handled in a [`select()`][frequenz.channels.util.select] loop.</span>

<span class="sd">    This exception is raised when a `select()` iteration finishes without a call to</span>
<span class="sd">    [`selected_from()`][frequenz.channels.util.selected_from] for the selected receiver.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected</span><span class="p">:</span> <span class="n">Selected</span><span class="p">[</span><span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            selected: The selected receiver that was not handled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">recv</span> <span class="o">=</span> <span class="n">selected</span><span class="o">.</span><span class="n">_recv</span>  <span class="c1"># pylint: disable=protected-access</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected receiver </span><span class="si">{</span><span class="n">recv</span><span class="si">}</span><span class="s2"> was not handled in the if-chain&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="n">selected</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<h5 id="frequenz.channels.util.UnhandledSelectedError-functions">Functions<a href="#frequenz.channels.util.UnhandledSelectedError-functions" class="headerlink" title="Permanent link"></a></h5>

<div class="doc doc-object doc-function">



<h6 id="frequenz.channels.util._select.UnhandledSelectedError.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span></code>

<a href="#frequenz.channels.util._select.UnhandledSelectedError.__init__" class="headerlink" title="Permanent link"></a></h6>


  <div class="doc doc-contents ">
  
      <p>Create a new instance.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>selected</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The selected receiver that was not handled.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._select.Selected" href="#frequenz.channels.util.Selected">Selected</a>[<span title="frequenz.channels.util._select._T">_T</span>]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected</span><span class="p">:</span> <span class="n">Selected</span><span class="p">[</span><span class="n">_T</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        selected: The selected receiver that was not handled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">recv</span> <span class="o">=</span> <span class="n">selected</span><span class="o">.</span><span class="n">_recv</span>  <span class="c1"># pylint: disable=protected-access</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected receiver </span><span class="si">{</span><span class="n">recv</span><span class="si">}</span><span class="s2"> was not handled in the if-chain&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="n">selected</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>
<h3 id="frequenz.channels.util-functions">Functions<a href="#frequenz.channels.util-functions" class="headerlink" title="Permanent link"></a></h3>

<div class="doc doc-object doc-function">



<h4 id="frequenz.channels.util.select" class="doc doc-heading">
<code class="highlight language-python"><span class="n">frequenz</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="n">receivers</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#frequenz.channels.util.select" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
  
      <p>Iterate over the values of all receivers as they receive new values.</p>
<p>This function is used to iterate over the values of all receivers as they receive
new values.  It is used in conjunction with the
<a class="autorefs autorefs-internal" href="#frequenz.channels.util.Selected"><code>Selected</code></a> class and the
<a class="autorefs autorefs-internal" href="#frequenz.channels.util.selected_from"><code>selected_from()</code></a> function to determine
which function to determine which receiver was selected in a select operation.</p>
<p>An exhaustiveness check is performed at runtime to make sure all selected receivers
are handled in the if-chain, so you should call <code>selected_from()</code> with all the
receivers passed to <code>select()</code> inside the select loop, even if you plan to ignore
a value, to signal <code>select()</code> that you are purposefully ignoring the value.</p>

<details class="note" open>
  <summary>Note</summary>
  <p>The <code>select()</code> function is intended to be used in cases where the set of
receivers is static and known beforehand.  If you need to dynamically add/remove
receivers from a select loop, there are a few alternatives.  Depending on your
use case, one or the other could work better for you:</p>
<ul>
<li>Use <a class="autorefs autorefs-internal" href="#frequenz.channels.util.Merge"><code>Merge</code></a> or
  <a class="autorefs autorefs-internal" href="#frequenz.channels.util.MergeNamed"><code>MergeNamed</code></a>: this is useful when you
  have and unknown number of receivers of the same type that can be handled as
  a group.</li>
<li>Use tasks to manage each recever individually: this is better if there are no
  relationships between the receivers.</li>
<li>Break the <code>select()</code> loop and start a new one with the new set of receivers
  (this should be the last resort, as it has some performance implications
   because the loop needs to be restarted).</li>
</ul>
</details>
<details class="example" open>
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">assert_never</span>

<span class="kn">from</span> <span class="nn">frequenz.channels</span> <span class="kn">import</span> <span class="n">ReceiverStoppedError</span>
<span class="kn">from</span> <span class="nn">frequenz.channels.util</span> <span class="kn">import</span> <span class="n">select</span><span class="p">,</span> <span class="n">selected_from</span><span class="p">,</span> <span class="n">Timer</span>

<span class="n">timer1</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">periodic</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">timer2</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">timeout</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

<span class="k">async</span> <span class="k">for</span> <span class="n">selected</span> <span class="ow">in</span> <span class="n">select</span><span class="p">(</span><span class="n">timer1</span><span class="p">,</span> <span class="n">timer2</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">timer1</span><span class="p">):</span>
        <span class="c1"># Beware: `selected.value` might raise an exception, you can always</span>
        <span class="c1"># check for exceptions with `selected.exception` first or use</span>
        <span class="c1"># a try-except block. You can also quickly check if the receiver was</span>
        <span class="c1"># stopped and let any other unexpected exceptions bubble up.</span>
        <span class="k">if</span> <span class="n">selected</span><span class="o">.</span><span class="n">was_stopped</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;timer1 was stopped&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;timer1: now=</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2"> drift=</span><span class="si">{</span><span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">timer2</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">timer2</span><span class="p">):</span>
        <span class="c1"># Explicitly handling of exceptions</span>
        <span class="k">match</span> <span class="n">selected</span><span class="o">.</span><span class="n">exception</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">ReceiverStoppedError</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;timer2 was stopped&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="ne">Exception</span><span class="p">()</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;timer2: exception=</span><span class="si">{</span><span class="n">exception</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">case</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># All good, no exception, we can use `selected.value` safely</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;timer2: now=</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2"> drift=</span><span class="si">{</span><span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span> <span class="k">as</span> <span class="n">unhanded</span><span class="p">:</span>
                <span class="n">assert_never</span><span class="p">(</span><span class="n">unhanded</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># This is not necessary, as select() will check for exhaustiveness, but</span>
        <span class="c1"># it is good practice to have it in case you forgot to handle a new</span>
        <span class="c1"># receiver added to `select()` at a later point in time.</span>
        <span class="k">assert</span> <span class="kc">False</span>
</code></pre></div>
</details>
  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>*receivers</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The receivers to select from.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
                </span>
                <span class="doc-param-default">
                  <b>DEFAULT:</b> 
                    <code>()</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>YIELDS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-yields-annotation">
                  <code><a class="autorefs autorefs-external" title="typing.AsyncIterator" href="https://docs.python.org/3/library/typing.html#typing.AsyncIterator">AsyncIterator</a>[<a class="autorefs autorefs-internal" title="frequenz.channels.util._select.Selected" href="#frequenz.channels.util.Selected">Selected</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]]</code>
              </span>
          </td>
          <td class="doc-yields-details">
            <div class="doc-md-description">
              <p>The currently selected item.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RAISES</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._select.UnhandledSelectedError" href="#frequenz.channels.util.UnhandledSelectedError">UnhandledSelectedError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>If a selected receiver was not handled in the if-chain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._select.SelectErrorGroup" href="#frequenz.channels.util.SelectErrorGroup">SelectErrorGroup</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>If there is an error while finishing the select operation and
receivers fail while cleaning up.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <span class="doc-raises-annotation">
                <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._select.SelectError" href="#frequenz.channels.util.SelectError">SelectError</a></code>
            </span>
          </td>
          <td class="doc-raises-details">
            <div class="doc-md-description">
              <p>If there is an error while selecting receivers during normal
operation.  For example if a receiver raises an exception in the <code>ready()</code>
method.  Normal errors while receiving values are not raised, but reported
via the <code>Selected</code> instance.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="o">*</span><span class="n">receivers</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">AsyncIterator</span><span class="p">[</span><span class="n">Selected</span><span class="p">[</span><span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Iterate over the values of all receivers as they receive new values.</span>

<span class="sd">    This function is used to iterate over the values of all receivers as they receive</span>
<span class="sd">    new values.  It is used in conjunction with the</span>
<span class="sd">    [`Selected`][frequenz.channels.util.Selected] class and the</span>
<span class="sd">    [`selected_from()`][frequenz.channels.util.selected_from] function to determine</span>
<span class="sd">    which function to determine which receiver was selected in a select operation.</span>

<span class="sd">    An exhaustiveness check is performed at runtime to make sure all selected receivers</span>
<span class="sd">    are handled in the if-chain, so you should call `selected_from()` with all the</span>
<span class="sd">    receivers passed to `select()` inside the select loop, even if you plan to ignore</span>
<span class="sd">    a value, to signal `select()` that you are purposefully ignoring the value.</span>

<span class="sd">    Note:</span>
<span class="sd">        The `select()` function is intended to be used in cases where the set of</span>
<span class="sd">        receivers is static and known beforehand.  If you need to dynamically add/remove</span>
<span class="sd">        receivers from a select loop, there are a few alternatives.  Depending on your</span>
<span class="sd">        use case, one or the other could work better for you:</span>

<span class="sd">        * Use [`Merge`][frequenz.channels.util.Merge] or</span>
<span class="sd">          [`MergeNamed`][frequenz.channels.util.MergeNamed]: this is useful when you</span>
<span class="sd">          have and unknown number of receivers of the same type that can be handled as</span>
<span class="sd">          a group.</span>
<span class="sd">        * Use tasks to manage each recever individually: this is better if there are no</span>
<span class="sd">          relationships between the receivers.</span>
<span class="sd">        * Break the `select()` loop and start a new one with the new set of receivers</span>
<span class="sd">          (this should be the last resort, as it has some performance implications</span>
<span class="sd">           because the loop needs to be restarted).</span>

<span class="sd">    Example:</span>
<span class="sd">        ```python</span>
<span class="sd">        import datetime</span>
<span class="sd">        from typing import assert_never</span>

<span class="sd">        from frequenz.channels import ReceiverStoppedError</span>
<span class="sd">        from frequenz.channels.util import select, selected_from, Timer</span>

<span class="sd">        timer1 = Timer.periodic(datetime.timedelta(seconds=1))</span>
<span class="sd">        timer2 = Timer.timeout(datetime.timedelta(seconds=0.5))</span>

<span class="sd">        async for selected in select(timer1, timer2):</span>
<span class="sd">            if selected_from(selected, timer1):</span>
<span class="sd">                # Beware: `selected.value` might raise an exception, you can always</span>
<span class="sd">                # check for exceptions with `selected.exception` first or use</span>
<span class="sd">                # a try-except block. You can also quickly check if the receiver was</span>
<span class="sd">                # stopped and let any other unexpected exceptions bubble up.</span>
<span class="sd">                if selected.was_stopped:</span>
<span class="sd">                    print(&quot;timer1 was stopped&quot;)</span>
<span class="sd">                    continue</span>
<span class="sd">                print(f&quot;timer1: now={datetime.datetime.now()} drift={selected.value}&quot;)</span>
<span class="sd">                timer2.stop()</span>
<span class="sd">            elif selected_from(selected, timer2):</span>
<span class="sd">                # Explicitly handling of exceptions</span>
<span class="sd">                match selected.exception:</span>
<span class="sd">                    case ReceiverStoppedError():</span>
<span class="sd">                        print(&quot;timer2 was stopped&quot;)</span>
<span class="sd">                    case Exception() as exception:</span>
<span class="sd">                        print(f&quot;timer2: exception={exception}&quot;)</span>
<span class="sd">                    case None:</span>
<span class="sd">                        # All good, no exception, we can use `selected.value` safely</span>
<span class="sd">                        print(</span>
<span class="sd">                            f&quot;timer2: now={datetime.datetime.now()} drift={selected.value}&quot;</span>
<span class="sd">                        )</span>
<span class="sd">                    case _ as unhanded:</span>
<span class="sd">                        assert_never(unhanded)</span>
<span class="sd">            else:</span>
<span class="sd">                # This is not necessary, as select() will check for exhaustiveness, but</span>
<span class="sd">                # it is good practice to have it in case you forgot to handle a new</span>
<span class="sd">                # receiver added to `select()` at a later point in time.</span>
<span class="sd">                assert False</span>
<span class="sd">        ```</span>

<span class="sd">    Args:</span>
<span class="sd">        *receivers: The receivers to select from.</span>

<span class="sd">    Yields:</span>
<span class="sd">        The currently selected item.</span>

<span class="sd">    Raises:</span>
<span class="sd">        UnhandledSelectedError: If a selected receiver was not handled in the if-chain.</span>
<span class="sd">        SelectErrorGroup: If there is an error while finishing the select operation and</span>
<span class="sd">            receivers fail while cleaning up.</span>
<span class="sd">        SelectError: If there is an error while selecting receivers during normal</span>
<span class="sd">            operation.  For example if a receiver raises an exception in the `ready()`</span>
<span class="sd">            method.  Normal errors while receiving values are not raised, but reported</span>
<span class="sd">            via the `Selected` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">receivers_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="n">r</span><span class="p">)):</span> <span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">receivers</span><span class="p">}</span>
    <span class="n">pending</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">recv</span> <span class="ow">in</span> <span class="n">receivers_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="n">ready</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">))</span>

        <span class="k">while</span> <span class="n">pending</span><span class="p">:</span>
            <span class="n">done</span><span class="p">,</span> <span class="n">pending</span> <span class="o">=</span> <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
                <span class="n">pending</span><span class="p">,</span> <span class="n">return_when</span><span class="o">=</span><span class="n">asyncio</span><span class="o">.</span><span class="n">FIRST_COMPLETED</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">done</span><span class="p">:</span>
                <span class="n">receiver_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
                <span class="n">recv</span> <span class="o">=</span> <span class="n">receivers_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">exception</span> <span class="o">:=</span> <span class="n">task</span><span class="o">.</span><span class="n">exception</span><span class="p">():</span>
                    <span class="k">match</span> <span class="n">exception</span><span class="p">:</span>
                        <span class="k">case</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">():</span>
                            <span class="c1"># If the receiver was cancelled, then it means we want to</span>
                            <span class="c1"># exit the select loop, so we handle the receiver but we</span>
                            <span class="c1"># don&#39;t add it back to the pending list.</span>
                            <span class="n">receiver_active</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">case</span><span class="w"> </span><span class="k">_</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">SelectError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error while selecting </span><span class="si">{</span><span class="n">recv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>

                <span class="n">selected</span> <span class="o">=</span> <span class="n">Selected</span><span class="p">(</span><span class="n">recv</span><span class="p">)</span>
                <span class="k">yield</span> <span class="n">selected</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">selected</span><span class="o">.</span><span class="n">_handled</span><span class="p">:</span>  <span class="c1"># pylint: disable=protected-access</span>
                    <span class="k">raise</span> <span class="n">UnhandledSelectedError</span><span class="p">(</span><span class="n">selected</span><span class="p">)</span>

                <span class="n">receiver_active</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">receiver_active</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="c1"># Add back the receiver to the pending list</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">task</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
                <span class="n">recv</span> <span class="o">=</span> <span class="n">receivers_map</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                <span class="n">pending</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">recv</span><span class="o">.</span><span class="n">ready</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">))</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">_stop_pending_tasks</span><span class="p">(</span><span class="n">pending</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h4 id="frequenz.channels.util.selected_from" class="doc doc-heading">
<code class="highlight language-python"><span class="n">frequenz</span><span class="o">.</span><span class="n">channels</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="n">receiver</span><span class="p">)</span></code>

<a href="#frequenz.channels.util.selected_from" class="headerlink" title="Permanent link"></a></h4>


  <div class="doc doc-contents ">
  
      <p>Check if the given receiver was selected by <a class="autorefs autorefs-internal" href="#frequenz.channels.util.select"><code>select()</code></a>.</p>
<p>This function is used in conjunction with the
<a class="autorefs autorefs-internal" href="#frequenz.channels.util.Selected"><code>Selected</code></a> class to determine which receiver was
selected in <code>select()</code> iteration.</p>
<p>It also works as a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/typing.html#typing.TypeGuard">type guard</a> to narrow the type of the
<code>Selected</code> instance to the type of the receiver.</p>
<p>Please see <a class="autorefs autorefs-internal" href="#frequenz.channels.util.select"><code>select()</code></a> for an example.</p>

  <table>
    <thead>
      <tr>
        <th><b>PARAMETER</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>selected</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The result of a <code>select()</code> iteration.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels.util._select.Selected" href="#frequenz.channels.util.Selected">Selected</a>[<a class="autorefs autorefs-external" title="typing.Any" href="https://docs.python.org/3/library/typing.html#typing.Any">Any</a>]</code>
                </span>
            </p>
          </td>
        </tr>
        <tr>
          <td><code>receiver</code></td>
          <td class="doc-param-details">
            <div class="doc-md-description">
              <p>The receiver to check if it was the source of a select operation.</p>
            </div>
            <p>
                <span class="doc-param-annotation">
                  <b>TYPE:</b>
                    <code><a class="autorefs autorefs-internal" title="frequenz.channels._base_classes.Receiver" href="../#frequenz.channels.Receiver">Receiver</a>[<span title="frequenz.channels.util._select._T">_T</span>]</code>
                </span>
            </p>
          </td>
        </tr>
    </tbody>
  </table>

  <table>
    <thead>
      <tr>
        <th><b>RETURNS</b></th>
        <th><b>DESCRIPTION</b></th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
              <span class="doc-returns-annotation">
                  <code><a class="autorefs autorefs-external" title="typing.TypeGuard" href="https://docs.python.org/3/library/typing.html#typing.TypeGuard">TypeGuard</a>[<a class="autorefs autorefs-internal" title="frequenz.channels.util._select.Selected" href="#frequenz.channels.util.Selected">Selected</a>[<span title="frequenz.channels.util._select._T">_T</span>]]</code>
              </span>
          </td>
          <td class="doc-returns-details">
            <div class="doc-md-description">
              <p>Whether the given receiver was selected.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>/opt/hostedtoolcache/Python/3.11.4/x64/lib/python3.11/site-packages/frequenz/channels/util/_select.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">selected_from</span><span class="p">(</span>
    <span class="n">selected</span><span class="p">:</span> <span class="n">Selected</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">receiver</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="n">_T</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TypeGuard</span><span class="p">[</span><span class="n">Selected</span><span class="p">[</span><span class="n">_T</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the given receiver was selected by [`select()`][frequenz.channels.util.select].</span>

<span class="sd">    This function is used in conjunction with the</span>
<span class="sd">    [`Selected`][frequenz.channels.util.Selected] class to determine which receiver was</span>
<span class="sd">    selected in `select()` iteration.</span>

<span class="sd">    It also works as a [type guard][typing.TypeGuard] to narrow the type of the</span>
<span class="sd">    `Selected` instance to the type of the receiver.</span>

<span class="sd">    Please see [`select()`][frequenz.channels.util.select] for an example.</span>

<span class="sd">    Args:</span>
<span class="sd">        selected: The result of a `select()` iteration.</span>
<span class="sd">        receiver: The receiver to check if it was the source of a select operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Whether the given receiver was selected.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">handled</span> <span class="o">:=</span> <span class="n">selected</span><span class="o">.</span><span class="n">_recv</span> <span class="ow">is</span> <span class="n">receiver</span><span class="p">:</span>  <span class="c1"># pylint: disable=protected-access</span>
        <span class="n">selected</span><span class="o">.</span><span class="n">_handled</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># pylint: disable=protected-access</span>
    <span class="k">return</span> <span class="n">handled</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright  2022 Frequenz Energy-as-a-Service GmbH
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/frequenz-floss" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/frequenz-com" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "navigation.tracking", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>